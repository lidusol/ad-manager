import { Component, Directive, ElementRef, HostListener, Input, Optional, Renderer2, ViewChild, Output, EventEmitter, ContentChildren, forwardRef, HostBinding } from '@angular/core';
import { LyOverlay, LyTheme2, Positioning, shadowBuilder, XPosition, YPosition, StyleCollection, LyOverlayPosition, StyleRenderer } from '@alyle/ui';
import { trigger, style, animate, transition, group } from '@angular/animations';
import { coerceBooleanProperty } from '@angular/cdk/coercion';
import { ViewportRuler } from '@angular/cdk/scrolling';
import { Subject, asapScheduler } from 'rxjs';
import { take, delay, debounceTime } from 'rxjs/operators';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@alyle/ui';
import * as ɵngcc2 from '@angular/cdk/scrolling';

const _c0 = ["container"];
const _c1 = ["*"];
const STYLE_PRIORITY = -1;
export const STYLES = (theme, ref) => {
    const menu = ref.selectorsOf(STYLES);
    const { after } = theme;
    return {
        $name: LyMenu.и,
        $priority: STYLE_PRIORITY,
        root: () => {
            var _a;
            return (((_a = theme.menu) === null || _a === void 0 ? void 0 : _a.root) && (theme.menu.root instanceof StyleCollection
                ? theme.menu.root.setTransformer(fn => fn(menu)).css
                : theme.menu.root(menu)));
        },
        container: (className) => `${className}{background:${theme.background.primary.default};border-radius:2px;box-shadow:${shadowBuilder(4)};display:block;padding-top:8px;padding-bottom:8px;transform-origin:inherit;pointer-events:all;overflow:auto;max-height:inherit;max-width:inherit;box-sizing:border-box;}`,
        item: (className) => `${className}{display:flex;min-height:48px;border-radius:0;width:100%;justify-content:flex-start;font-weight:400;}${className} ly-icon{margin-${after}:16px;}`,
        itemSubMenuTrigger: () => (className) => `${className}{padding-${after}:32px;}${className}::after{width:0;height:0;border-style:solid;border-width:5px 0 5px 5px;border-color:transparent transparent transparent currentColor;content:"";display:inline-block;position:absolute;top:50%;${after}:16px;transform:translateY(-50%);}`
    };
};
const ANIMATIONS = [
    trigger('transformMenu', [
        transition('void => enter', group([
            style({
                opacity: 0,
                transform: 'scale(0.8)'
            }),
            animate('100ms linear', style({
                opacity: 1
            })),
            animate('120ms cubic-bezier(0, 0, 0.2, 1)', style({ transform: 'scale(1)' })),
        ]))
    ]),
    trigger('transformMenuLeave', [
        transition('* => void', animate('100ms 25ms linear', style({ opacity: 0 })))
    ])
];
/** Menu container */
export class LyMenu {
    constructor(_theme, _el, _renderer, _viewportRuler, sRenderer) {
        this._theme = _theme;
        this._el = _el;
        this._renderer = _renderer;
        this._viewportRuler = _viewportRuler;
        this.sRenderer = sRenderer;
        /**
         * styles
         * @docs-private
         */
        this.classes = this.sRenderer.renderSheet(STYLES, true);
        /** Emits whenever an animation on the menu completes. */
        this._animationDone = new Subject();
        this._hasBackdrop = true;
    }
    /** Menu Trigger */
    set ref(value) {
        this._ref = value;
        this._menuRef = value._menuRef;
    }
    get ref() {
        return this._ref;
    }
    /** Whether the menu has a backdrop. */
    get hasBackdrop() {
        return this._hasBackdrop;
    }
    set hasBackdrop(value) {
        this._hasBackdrop = coerceBooleanProperty(value);
    }
    ngOnChanges() {
        var _a;
        if (((_a = this.ref) === null || _a === void 0 ? void 0 : _a._menuRef) && this._container) {
            // Update backdrop
            this.ref._menuRef.updateBackdrop(this.ref._isItemSubMenuTrigger() ? false : this.hasBackdrop);
            this._updatePlacement();
            this._checkBackdropAndOpenOnHover();
        }
    }
    ngOnInit() {
        if (!this.ref) {
            throw new Error('LyMenu: require @Input() ref');
        }
    }
    ngAfterViewInit() {
        if (this.ref._menuRef) {
            this.ref._menuRef.onResizeScroll = this._updatePlacement.bind(this);
            this.ref._menuRef.updateBackdrop(this.ref._isItemSubMenuTrigger() ? false : this.hasBackdrop);
            this._checkBackdropAndOpenOnHover();
        }
        this._updatePlacement();
        this.ref.menuOpened.emit();
        Promise.resolve(null).then(() => {
            this.ref._setMenuOpenToTrue();
        });
        const hostTrigger = this._getHostMenuTrigger();
        hostTrigger._menuDetached
            .pipe(take(1))
            .subscribe(() => this._ref.closeMenu());
        this._addOpenOnHover();
    }
    ngOnDestroy() {
        this._removeOpenOnHoverListeners();
    }
    _checkBackdropAndOpenOnHover() {
        var _a;
        const hostTrigger = this._getHostMenuTrigger();
        if (this.hasBackdrop && ((_a = hostTrigger._menuOpenOnHoverRef) === null || _a === void 0 ? void 0 : _a.openOnHover)) {
            throw new Error(`${LyMenu.и}: Can't use [hasBackdrop] with [openOnHover] at the same time, set [hasBackdrop] to false to use [openOnHover]`);
        }
    }
    _getHostMenuTrigger() {
        var _a;
        let menuTrigger = this.ref;
        while ((_a = menuTrigger._menu) === null || _a === void 0 ? void 0 : _a.ref) {
            menuTrigger = menuTrigger._menu.ref;
        }
        return menuTrigger;
    }
    _addOpenOnHover() {
        var _a;
        const hostTrigger = this._getHostMenuTrigger();
        if (((_a = hostTrigger._menuOpenOnHoverRef) === null || _a === void 0 ? void 0 : _a.openOnHover) && !this._mouseenterListen && !this._mouseleaveListen) {
            hostTrigger._menuOpenOnHoverRef._handleMouseEnterOrLeave(true);
            this._mouseenterListen = this._renderer
                .listen(this._el.nativeElement, 'mouseenter', () => hostTrigger._menuOpenOnHoverRef._handleMouseEnterOrLeave(true));
            this._mouseleaveListen = this._renderer
                .listen(this._el.nativeElement, 'mouseleave', () => hostTrigger._menuOpenOnHoverRef._handleMouseEnterOrLeave(false));
        }
    }
    /** Remove listeners */
    _removeOpenOnHoverListeners() {
        if (this._mouseenterListen) {
            this._mouseenterListen();
        }
        if (this._mouseleaveListen) {
            this._mouseleaveListen();
        }
    }
    /** Update Menu Position */
    _updatePlacement() {
        var _a, _b;
        const el = (_a = this.ref._menuRef) === null || _a === void 0 ? void 0 : _a.containerElement;
        const container = (_b = this._container) === null || _b === void 0 ? void 0 : _b.nativeElement;
        // Do not update when not available
        if (!el || !container) {
            return;
        }
        // reset height & width
        this._renderer.setStyle(container, 'height', 'initial');
        this._renderer.setStyle(container, 'width', 'initial');
        const position = this.placement
            ? new Positioning(this.placement, this.xPosition, this.yPosition, this.ref._getHostElement(), el, this._theme.variables)
            : !this.ref._isItemSubMenuTrigger()
                ? new LyOverlayPosition(this._theme, this._viewportRuler, this.ref._getHostElement(), el)
                    .setXAnchor(this.xAnchor)
                    .setYAnchor(this.yAnchor)
                    .setXAxis(this.xAxis)
                    .setYAxis(this.yAxis)
                    .setFlip(true)
                    .build()
                : new LyOverlayPosition(this._theme, this._viewportRuler, this.ref._getHostElement(), el)
                    .setXAnchor(XPosition.after)
                    .setYAnchor(YPosition.above)
                    .setFlip(true)
                    .build();
        if (position instanceof Positioning) {
            // set position deprecated
            this._renderer.setStyle(el, 'transform', `translate3d(${position.x}px, ${position.y}px, 0)`);
            this._renderer.setStyle(this._el.nativeElement, 'transform-origin', `${position.ox} ${position.oy} 0`);
            // set height & width deprecated
            this._renderer.setStyle(container, 'height', position.height === 'initial' ? '100%' : position.height);
            this._renderer.setStyle(container, 'width', position.width === 'initial' ? '100%' : position.width);
        }
        else {
            // set position
            this._renderer.setStyle(el, 'left', `${position.x}px`);
            this._renderer.setStyle(el, 'top', `${position.y}px`);
            this._renderer.setStyle(container, 'width', position.width ? `${position.width}px` : '100%');
            this._renderer.setStyle(container, 'height', position.height ? `${position.height}px` : '100%');
            this._renderer.setStyle(this._el.nativeElement, 'transform-origin', `${position.xo}px ${position.yo}px 0`);
        }
    }
    _onAnimationStart(event) {
        this._isAnimating = true;
        if (event.triggerName === 'transformMenuLeave' && event.toState === 'void') {
            this._isDestroying = true;
        }
    }
    _onAnimationDone(event) {
        this._animationDone.next(event);
        this._isAnimating = false;
        if (event.toState === 'void' && event.triggerName === 'transformMenuLeave') {
            this.ref.destroy(this._menuRef);
        }
    }
}
LyMenu.ɵfac = function LyMenu_Factory(t) { return new (t || LyMenu)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LyTheme2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.ViewportRuler), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.StyleRenderer)); };
LyMenu.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: LyMenu, selectors: [["ly-menu"]], contentQueries: function LyMenu_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, LyMenuItem, false);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.menuItems = _t);
    } }, viewQuery: function LyMenu_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx._container = _t.first);
    } }, hostVars: 1, hostBindings: function LyMenu_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵcomponentHostSyntheticListener("@transformMenuLeave.start", function LyMenu_animation_transformMenuLeave_start_HostBindingHandler($event) { return ctx._onAnimationStart($event); })("@transformMenuLeave.done", function LyMenu_animation_transformMenuLeave_done_HostBindingHandler($event) { return ctx._onAnimationDone($event); });
    } if (rf & 2) {
        ɵngcc0.ɵɵupdateSyntheticHostBinding("@transformMenuLeave", ctx.transformMenuLeave);
    } }, inputs: { ref: "ref", hasBackdrop: "hasBackdrop", xAnchor: "xAnchor", yAnchor: "yAnchor", xAxis: "xAxis", yAxis: "yAxis", placement: "placement", xPosition: "xPosition", yPosition: "yPosition" }, exportAs: ["lyMenu"], features: [ɵngcc0.ɵɵProvidersFeature([
            StyleRenderer
        ]), ɵngcc0.ɵɵNgOnChangesFeature], ngContentSelectors: _c1, decls: 3, vars: 3, consts: [["container", ""]], template: function LyMenu_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef();
        ɵngcc0.ɵɵelementStart(0, "div", null, 0);
        ɵngcc0.ɵɵlistener("@transformMenu.start", function LyMenu_Template_div_animation_transformMenu_start_0_listener($event) { return ctx._onAnimationStart($event); })("@transformMenu.done", function LyMenu_Template_div_animation_transformMenu_done_0_listener($event) { return ctx._onAnimationDone($event); });
        ɵngcc0.ɵɵprojection(2);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵclassMap(ctx.classes.container);
        ɵngcc0.ɵɵproperty("@transformMenu", "enter");
    } }, encapsulation: 2, data: { animation: [...ANIMATIONS] } });
/** @docs-private */
LyMenu.и = 'LyMenu';
LyMenu.ctorParameters = () => [
    { type: LyTheme2 },
    { type: ElementRef },
    { type: Renderer2 },
    { type: ViewportRuler },
    { type: StyleRenderer }
];
LyMenu.propDecorators = {
    ref: [{ type: Input }],
    hasBackdrop: [{ type: Input }],
    _container: [{ type: ViewChild, args: ['container',] }],
    menuItems: [{ type: ContentChildren, args: [forwardRef(() => LyMenuItem),] }],
    xAnchor: [{ type: Input }],
    yAnchor: [{ type: Input }],
    xAxis: [{ type: Input }],
    yAxis: [{ type: Input }],
    placement: [{ type: Input }],
    xPosition: [{ type: Input }],
    yPosition: [{ type: Input }],
    transformMenuLeave: [{ type: HostBinding, args: ['@transformMenuLeave',] }],
    _onAnimationStart: [{ type: HostListener, args: ['@transformMenuLeave.start', ['$event'],] }],
    _onAnimationDone: [{ type: HostListener, args: ['@transformMenuLeave.done', ['$event'],] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(LyMenu, [{
        type: Component,
        args: [{
                selector: 'ly-menu',
                animations: [...ANIMATIONS],
                template: "<div #container\n  [class]=\"classes.container\"\n  [@transformMenu]=\"'enter'\"\n  (@transformMenu.start)=\"_onAnimationStart($event)\"\n  (@transformMenu.done)=\"_onAnimationDone($event)\"\n>\n  <ng-content></ng-content>\n</div>",
                exportAs: 'lyMenu',
                providers: [
                    StyleRenderer
                ]
            }]
    }], function () { return [{ type: ɵngcc1.LyTheme2 }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc2.ViewportRuler }, { type: ɵngcc1.StyleRenderer }]; }, { ref: [{
            type: Input
        }], hasBackdrop: [{
            type: Input
        }], _onAnimationStart: [{
            type: HostListener,
            args: ['@transformMenuLeave.start', ['$event']]
        }], _onAnimationDone: [{
            type: HostListener,
            args: ['@transformMenuLeave.done', ['$event']]
        }], _container: [{
            type: ViewChild,
            args: ['container']
        }], menuItems: [{
            type: ContentChildren,
            args: [forwardRef(() => LyMenuItem)]
        }], xAnchor: [{
            type: Input
        }], yAnchor: [{
            type: Input
        }], xAxis: [{
            type: Input
        }], yAxis: [{
            type: Input
        }], placement: [{
            type: Input
        }], xPosition: [{
            type: Input
        }], yPosition: [{
            type: Input
        }], transformMenuLeave: [{
            type: HostBinding,
            args: ['@transformMenuLeave']
        }] }); })();
export class LyMenuItem {
    constructor(_menu, el, renderer) {
        this._menu = _menu;
        renderer.addClass(el.nativeElement, _menu.classes.item);
    }
    _handleClick() {
        var _a;
        if (this._menu.ref && this._menu.ref._menuRef) {
            if (!this._getItemSubMenuTrigger()) {
                let currentTrigger = this._menu.ref;
                while (currentTrigger) {
                    currentTrigger.closeMenu();
                    currentTrigger = (_a = currentTrigger._menu) === null || _a === void 0 ? void 0 : _a.ref;
                }
            }
        }
    }
    _handleMouseEnter() {
        const itemSubMenuTrigger = this._getItemSubMenuTrigger();
        if (itemSubMenuTrigger && !this._menu._isDestroying) {
            if (this._menu._isAnimating) {
                this._menu._animationDone
                    .pipe(take(1), delay(0, asapScheduler))
                    .subscribe(() => {
                    itemSubMenuTrigger.openMenu();
                    this._closeOtherMenus();
                });
            }
            else {
                itemSubMenuTrigger.openMenu();
                this._closeOtherMenus();
            }
        }
        else {
            this._closeOtherMenus();
        }
    }
    /** Except for this, close all menus */
    _closeOtherMenus() {
        this._menu.menuItems.forEach(menuItem => {
            var _a;
            if (menuItem !== this) {
                (_a = menuItem._getItemSubMenuTrigger()) === null || _a === void 0 ? void 0 : _a.closeMenu();
            }
        });
    }
    _setItemSubMenuTrigger(menuTrigger) {
        this._itemSubMenuTrigger = menuTrigger;
    }
    _getItemSubMenuTrigger() {
        return this._itemSubMenuTrigger;
    }
}
LyMenuItem.ɵfac = function LyMenuItem_Factory(t) { return new (t || LyMenuItem)(ɵngcc0.ɵɵdirectiveInject(LyMenu, 8), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2)); };
LyMenuItem.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: LyMenuItem, selectors: [["", "ly-menu-item", ""]], hostBindings: function LyMenuItem_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("click", function LyMenuItem_click_HostBindingHandler() { return ctx._handleClick(); })("mouseenter", function LyMenuItem_mouseenter_HostBindingHandler() { return ctx._handleMouseEnter(); });
    } } });
LyMenuItem.ctorParameters = () => [
    { type: LyMenu, decorators: [{ type: Optional }] },
    { type: ElementRef },
    { type: Renderer2 }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(LyMenuItem, [{
        type: Directive,
        args: [{
                selector: '[ly-menu-item]',
                host: {
                    '(click)': '_handleClick()',
                    '(mouseenter)': '_handleMouseEnter()'
                }
            }]
    }], function () { return [{ type: LyMenu, decorators: [{
                type: Optional
            }] }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }]; }, null); })();
export class LyMenuTriggerFor {
    constructor(elementRef, overlay, _menuItem, sRenderer, _menu) {
        this.elementRef = elementRef;
        this.overlay = overlay;
        this._menuItem = _menuItem;
        this.sRenderer = sRenderer;
        this._menu = _menu;
        this.classes = this.sRenderer.renderSheet(STYLES);
        this._menuOpen = false;
        this._menuDetached = new Subject();
        this.menuOpened = new EventEmitter();
        this.menuClosed = new EventEmitter();
        if (this._isItemSubMenuTrigger()) {
            _menuItem._setItemSubMenuTrigger(this);
            sRenderer.addClass(this.classes.itemSubMenuTrigger);
        }
    }
    /** Whether the menu is open. */
    get menuOpen() {
        return this._menuOpen;
    }
    ngOnDestroy() {
        // Not force destruction if it is already being destroyed
        if (!this._destroying) {
            this.closeMenu();
        }
        this._menuDetached.complete();
    }
    _handleClick() {
        if (!this._isItemSubMenuTrigger()) {
            this.toggleMenu();
        }
    }
    /** Opens the menu */
    openMenu() {
        if (!this._menuRef) {
            this._menuRef = this.overlay.create(this.lyMenuTriggerFor, {
                $implicit: this,
                data: this.menuData
            }, {
                styles: {
                    top: 0,
                    left: 0,
                    pointerEvents: null
                },
                fnDestroy: this.detach.bind(this),
                hasBackdrop: false
            });
        }
    }
    /** Closes the menu */
    closeMenu() {
        this.detach();
    }
    /** Toggle menu */
    toggleMenu() {
        if (this._menuRef) {
            this.closeMenu();
        }
        else {
            this.openMenu();
        }
    }
    /** @docs-private */
    detach() {
        if (this._menuRef) {
            this._menuRef.detach();
            this._menuRef = null;
            this._destroying = true;
            this._menuDetached.next();
        }
    }
    /** @docs-private */
    destroy(menuRef) {
        this.menuClosed.emit(null);
        menuRef.remove();
        this._destroying = false;
        Promise.resolve(null).then(() => this._menuOpen = false);
    }
    _getHostElement() {
        return this.elementRef.nativeElement;
    }
    _setMenuOpenToTrue() {
        this._menuOpen = true;
    }
    /**
     * @docs-private
     */
    _isItemSubMenuTrigger() {
        return !!this._menuItem;
    }
}
LyMenuTriggerFor.ɵfac = function LyMenuTriggerFor_Factory(t) { return new (t || LyMenuTriggerFor)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.LyOverlay), ɵngcc0.ɵɵdirectiveInject(LyMenuItem, 8), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.StyleRenderer), ɵngcc0.ɵɵdirectiveInject(LyMenu, 8)); };
LyMenuTriggerFor.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: LyMenuTriggerFor, selectors: [["", "lyMenuTriggerFor", ""]], hostBindings: function LyMenuTriggerFor_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("click", function LyMenuTriggerFor_click_HostBindingHandler() { return ctx._handleClick(); });
    } }, inputs: { lyMenuTriggerFor: "lyMenuTriggerFor", menuData: ["lyMenuTriggerData", "menuData"] }, outputs: { menuOpened: "menuOpened", menuClosed: "menuClosed" }, exportAs: ["lyMenuTriggerFor"], features: [ɵngcc0.ɵɵProvidersFeature([
            StyleRenderer
        ])] });
LyMenuTriggerFor.ctorParameters = () => [
    { type: ElementRef },
    { type: LyOverlay },
    { type: LyMenuItem, decorators: [{ type: Optional }] },
    { type: StyleRenderer },
    { type: LyMenu, decorators: [{ type: Optional }] }
];
LyMenuTriggerFor.propDecorators = {
    lyMenuTriggerFor: [{ type: Input }],
    menuData: [{ type: Input, args: ['lyMenuTriggerData',] }],
    menuOpened: [{ type: Output }],
    menuClosed: [{ type: Output }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(LyMenuTriggerFor, [{
        type: Directive,
        args: [{
                selector: '[lyMenuTriggerFor]',
                host: {
                    '(click)': '_handleClick()'
                },
                exportAs: 'lyMenuTriggerFor',
                providers: [
                    StyleRenderer
                ]
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc1.LyOverlay }, { type: LyMenuItem, decorators: [{
                type: Optional
            }] }, { type: ɵngcc1.StyleRenderer }, { type: LyMenu, decorators: [{
                type: Optional
            }] }]; }, { menuOpened: [{
            type: Output
        }], menuClosed: [{
            type: Output
        }], lyMenuTriggerFor: [{
            type: Input
        }], menuData: [{
            type: Input,
            args: ['lyMenuTriggerData']
        }] }); })();
export class LyMenuOpenOnHover {
    constructor(_trigger) {
        this._trigger = _trigger;
        this._events = new Subject();
        this._openOnHover = true;
        _trigger._menuOpenOnHoverRef = this;
        this._events
            .pipe(debounceTime(200))
            .subscribe(enterOrLeave => {
            if (this.openOnHover) {
                if (enterOrLeave) {
                    _trigger.openMenu();
                }
                else {
                    _trigger.closeMenu();
                }
            }
        });
    }
    /** Whether menu should open on hover. */
    get openOnHover() {
        return this._openOnHover;
    }
    set openOnHover(value) {
        this._openOnHover = coerceBooleanProperty(value);
        Promise.resolve(null)
            .then(() => this._openOnHover
            ? this._trigger._menuOpenOnHoverRef = this
            : delete this._trigger._menuOpenOnHoverRef);
    }
    ngOnDestroy() {
        this._events.complete();
    }
    /** Handle mouseenter or mouseleave */
    _handleMouseEnterOrLeave(leaveOrEnter) {
        if (this.openOnHover) {
            if (leaveOrEnter) {
                this._trigger.openMenu();
            }
            this._events.next(leaveOrEnter);
        }
    }
}
LyMenuOpenOnHover.ɵfac = function LyMenuOpenOnHover_Factory(t) { return new (t || LyMenuOpenOnHover)(ɵngcc0.ɵɵdirectiveInject(LyMenuTriggerFor)); };
LyMenuOpenOnHover.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: LyMenuOpenOnHover, selectors: [["", "lyMenuTriggerFor", "", "openOnHover", ""]], hostBindings: function LyMenuOpenOnHover_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("mouseenter", function LyMenuOpenOnHover_mouseenter_HostBindingHandler() { return ctx._handleMouseEnterOrLeave(true); })("mouseleave", function LyMenuOpenOnHover_mouseleave_HostBindingHandler() { return ctx._handleMouseEnterOrLeave(false); });
    } }, inputs: { openOnHover: "openOnHover" } });
LyMenuOpenOnHover.ctorParameters = () => [
    { type: LyMenuTriggerFor }
];
LyMenuOpenOnHover.propDecorators = {
    openOnHover: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(LyMenuOpenOnHover, [{
        type: Directive,
        args: [{
                selector: '[lyMenuTriggerFor][openOnHover]',
                host: {
                    '(mouseenter)': '_handleMouseEnterOrLeave(true)',
                    '(mouseleave)': '_handleMouseEnterOrLeave(false)'
                }
            }]
    }], function () { return [{ type: LyMenuTriggerFor }]; }, { openOnHover: [{
            type: Input
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vbGliL21lbnUvbWVudS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBRUwsU0FBUyxFQUNULFNBQVMsRUFDVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLEtBQUssRUFHTCxRQUFRLEVBQ1IsU0FBUyxFQUVULFNBQVMsRUFDVCxNQUFNLEVBQ04sWUFBWSxFQUVaLGVBQWUsRUFDZixVQUFVLEVBRVYsV0FBVyxFQUNWLE1BQU0sZUFBZSxDQUFDO0FBQ3pCLE9BQU8sRUFDTCxTQUFTLEVBQ1QsUUFBUSxFQUdSLFdBQVcsRUFDWCxhQUFhLEVBRWIsU0FBUyxFQUNULFNBQVMsRUFDVCxlQUFlLEVBSWYsaUJBQWlCLEVBQ2pCLGFBQWEsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUNuQyxPQUFPLEVBQ0wsT0FBTyxFQUNQLEtBQUssRUFDTCxPQUFPLEVBQ1AsVUFBVSxFQUVWLEtBQUssRUFDTixNQUFNLHFCQUFxQixDQUFDO0FBQzdCLE9BQU8sRUFBZ0IscUJBQXFCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUM1RSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDdkQsT0FBTyxFQUFFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDOUMsT0FBTyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7Ozs7Ozs7QUFZM0QsTUFBTSxjQUFjLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFFMUIsTUFBTSxDQUFDLE1BQU0sTUFBTSxHQUFHLENBQUMsS0FBdUMsRUFBRSxHQUFhLEVBQUUsRUFBRTtBQUNqRixJQUFFLE1BQU0sSUFBSSxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDdkMsSUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsS0FBSyxDQUFDO0FBQzFCLElBQUUsT0FBTztBQUNULFFB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QUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVk7QUFDakMsWUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsR0FBRyxJQUFJO0FBQ2hELFlBQU0sQ0FBQyxDQUFDLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0FBQ2xELElBQUUsQ0FBQztBQUNILElBcUJFLFdBQVc7QUFDYixRQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDNUIsSUFBRSxDQUFDO0FBQ0gsSUFLRSxzQ0FBc0M7QUFDeEMsSUFBRSx3QkFBd0IsQ0FBQyxZQUFxQjtBQUFJLFFBQ2hELElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtBQUMxQixZQUFNLElBQUksWUFBWSxFQUFFO0FBQ3hCLGdCQUFRLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDakMsYUFBTztBQUNQLFlBQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDdEMsU0FBSztBQUNMLElBQUUsQ0FBQztBQUNIOzZDQTdEQyxTQUFTLFNBQUMsa0JBQ1QsUUFBUSxFQUFFLGlDQUFpQyxrQkFDM0MsSUFBSSxFQUFFO3FCQUNKLGNBQWMsRUFBRSxnQ0FBZ0Msc0JBQ2hELGNBQWMsRUFBRSxpQ0FBaUMsa0JBQ2xELGNBQ0Y7O21EQUNJO0FBQUM7QUFBMkMsWUFtQjNCLGdCQUFnQjtBQUNwQztBQUFHO0FBQytCLDBCQWhCakMsS0FBSztBQUNQOzs7Ozs7Ozs7Ozs7b0JBQUU7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0luaXQsXG4gIENvbXBvbmVudCxcbiAgRGlyZWN0aXZlLFxuICBFbGVtZW50UmVmLFxuICBIb3N0TGlzdGVuZXIsXG4gIElucHV0LFxuICBPbkRlc3Ryb3ksXG4gIE9uSW5pdCxcbiAgT3B0aW9uYWwsXG4gIFJlbmRlcmVyMixcbiAgVGVtcGxhdGVSZWYsXG4gIFZpZXdDaGlsZCxcbiAgT3V0cHV0LFxuICBFdmVudEVtaXR0ZXIsXG4gIE9uQ2hhbmdlcyxcbiAgQ29udGVudENoaWxkcmVuLFxuICBmb3J3YXJkUmVmLFxuICBRdWVyeUxpc3QsXG4gIEhvc3RCaW5kaW5nXG4gIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICBMeU92ZXJsYXksXG4gIEx5VGhlbWUyLFxuICBPdmVybGF5RmFjdG9yeSxcbiAgUGxhY2VtZW50LFxuICBQb3NpdGlvbmluZyxcbiAgc2hhZG93QnVpbGRlcixcbiAgVGhlbWVWYXJpYWJsZXMsXG4gIFhQb3NpdGlvbixcbiAgWVBvc2l0aW9uLFxuICBTdHlsZUNvbGxlY3Rpb24sXG4gIEx5Q2xhc3NlcyxcbiAgU3R5bGVUZW1wbGF0ZSxcbiAgVGhlbWVSZWYsXG4gIEx5T3ZlcmxheVBvc2l0aW9uLFxuICBTdHlsZVJlbmRlcmVyIH0gZnJvbSAnQGFseWxlL3VpJztcbmltcG9ydCB7XG4gIHRyaWdnZXIsXG4gIHN0eWxlLFxuICBhbmltYXRlLFxuICB0cmFuc2l0aW9uLFxuICBBbmltYXRpb25FdmVudCxcbiAgZ3JvdXBcbn0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XG5pbXBvcnQgeyBCb29sZWFuSW5wdXQsIGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eSB9IGZyb20gJ0Bhbmd1bGFyL2Nkay9jb2VyY2lvbic7XG5pbXBvcnQgeyBWaWV3cG9ydFJ1bGVyIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL3Njcm9sbGluZyc7XG5pbXBvcnQgeyBTdWJqZWN0LCBhc2FwU2NoZWR1bGVyIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyB0YWtlLCBkZWxheSwgZGVib3VuY2VUaW1lIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEx5TWVudVRoZW1lIHtcbiAgLyoqIFN0eWxlcyBmb3IgTWVudSBDb21wb25lbnQgKi9cbiAgcm9vdD86IFN0eWxlQ29sbGVjdGlvbjwoKGNsYXNzZXM6IEx5Q2xhc3Nlczx0eXBlb2YgU1RZTEVTPikgPT4gU3R5bGVUZW1wbGF0ZSk+XG4gICAgfCAoKGNsYXNzZXM6IEx5Q2xhc3Nlczx0eXBlb2YgU1RZTEVTPikgPT4gU3R5bGVUZW1wbGF0ZSk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTHlNZW51VmFyaWFibGVzIHtcbiAgbWVudT86IEx5TWVudVRoZW1lO1xufVxuXG5jb25zdCBTVFlMRV9QUklPUklUWSA9IC0xO1xuXG5leHBvcnQgY29uc3QgU1RZTEVTID0gKHRoZW1lOiBUaGVtZVZhcmlhYmxlcyAmIEx5TWVudVZhcmlhYmxlcywgcmVmOiBUaGVtZVJlZikgPT4ge1xuICBjb25zdCBtZW51ID0gcmVmLnNlbGVjdG9yc09mKFNUWUxFUyk7XG4gIGNvbnN0IHsgYWZ0ZXIgfSA9IHRoZW1lO1xuICByZXR1cm4ge1xuICAgICRuYW1lOiBMeU1lbnUu0LgsXG4gICAgJHByaW9yaXR5OiBTVFlMRV9QUklPUklUWSxcbiAgICByb290OiAoKSA9PiAoXG4gICAgICB0aGVtZS5tZW51Py5yb290XG4gICAgICAgICYmICh0aGVtZS5tZW51LnJvb3QgaW5zdGFuY2VvZiBTdHlsZUNvbGxlY3Rpb25cbiAgICAgICAgICA/IHRoZW1lLm1lbnUucm9vdC5zZXRUcmFuc2Zvcm1lcihmbiA9PiBmbihtZW51KSkuY3NzXG4gICAgICAgICAgOiB0aGVtZS5tZW51LnJvb3QobWVudSkpXG4gICAgKSxcbiAgICBjb250YWluZXI6IChjbGFzc05hbWU6IHN0cmluZykgPT4gYCR7Y2xhc3NOYW1lfXtiYWNrZ3JvdW5kOiR7dGhlbWUuYmFja2dyb3VuZC5wcmltYXJ5LmRlZmF1bHR9O2JvcmRlci1yYWRpdXM6MnB4O2JveC1zaGFkb3c6JHtzaGFkb3dCdWlsZGVyKDQpfTtkaXNwbGF5OmJsb2NrO3BhZGRpbmctdG9wOjhweDtwYWRkaW5nLWJvdHRvbTo4cHg7dHJhbnNmb3JtLW9yaWdpbjppbmhlcml0O3BvaW50ZXItZXZlbnRzOmFsbDtvdmVyZmxvdzphdXRvO21heC1oZWlnaHQ6aW5oZXJpdDttYXgtd2lkdGg6aW5oZXJpdDtib3gtc2l6aW5nOmJvcmRlci1ib3g7fWAsXG4gICAgaXRlbTogKGNsYXNzTmFtZTogc3RyaW5nKSA9PiBgJHtjbGFzc05hbWV9e2Rpc3BsYXk6ZmxleDttaW4taGVpZ2h0OjQ4cHg7Ym9yZGVyLXJhZGl1czowO3dpZHRoOjEwMCU7anVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnQ7Zm9udC13ZWlnaHQ6NDAwO30ke2NsYXNzTmFtZX0gbHktaWNvbnttYXJnaW4tJHthZnRlcn06MTZweDt9YCxcbiAgICBpdGVtU3ViTWVudVRyaWdnZXI6ICgpID0+IChjbGFzc05hbWU6IHN0cmluZykgPT4gYCR7Y2xhc3NOYW1lfXtwYWRkaW5nLSR7YWZ0ZXJ9OjMycHg7fSR7Y2xhc3NOYW1lfTo6YWZ0ZXJ7d2lkdGg6MDtoZWlnaHQ6MDtib3JkZXItc3R5bGU6c29saWQ7Ym9yZGVyLXdpZHRoOjVweCAwIDVweCA1cHg7Ym9yZGVyLWNvbG9yOnRyYW5zcGFyZW50IHRyYW5zcGFyZW50IHRyYW5zcGFyZW50IGN1cnJlbnRDb2xvcjtjb250ZW50OlwiXCI7ZGlzcGxheTppbmxpbmUtYmxvY2s7cG9zaXRpb246YWJzb2x1dGU7dG9wOjUwJTske2FmdGVyfToxNnB4O3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpO31gXG4gIH07XG59O1xuXG5jb25zdCBBTklNQVRJT05TID0gW1xuICB0cmlnZ2VyKCd0cmFuc2Zvcm1NZW51JywgW1xuICAgIHRyYW5zaXRpb24oJ3ZvaWQgPT4gZW50ZXInLCBncm91cChbXG4gICAgICBzdHlsZSh7XG4gICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgIHRyYW5zZm9ybTogJ3NjYWxlKDAuOCknXG4gICAgICB9KSxcbiAgICAgIGFuaW1hdGUoJzEwMG1zIGxpbmVhcicsIHN0eWxlKHtcbiAgICAgICAgb3BhY2l0eTogMVxuICAgICAgfSkpLFxuICAgICAgYW5pbWF0ZSgnMTIwbXMgY3ViaWMtYmV6aWVyKDAsIDAsIDAuMiwgMSknLCBzdHlsZSh7dHJhbnNmb3JtOiAnc2NhbGUoMSknfSkpLFxuICAgIF0pKVxuICBdKSxcbiAgdHJpZ2dlcigndHJhbnNmb3JtTWVudUxlYXZlJywgW1xuICAgIHRyYW5zaXRpb24oJyogPT4gdm9pZCcsIGFuaW1hdGUoJzEwMG1zIDI1bXMgbGluZWFyJywgc3R5bGUoeyBvcGFjaXR5OiAwIH0pKSlcbiAgXSlcbl07XG5cbi8qKiBNZW51IGNvbnRhaW5lciAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbHktbWVudScsXG4gIGFuaW1hdGlvbnM6IFsuLi5BTklNQVRJT05TXSxcbiAgdGVtcGxhdGVVcmw6ICdtZW51Lmh0bWwnLFxuICBleHBvcnRBczogJ2x5TWVudScsXG4gIHByb3ZpZGVyczogW1xuICAgIFN0eWxlUmVuZGVyZXJcbiAgXVxufSlcbmV4cG9ydCBjbGFzcyBMeU1lbnUgaW1wbGVtZW50cyBPbkNoYW5nZXMsIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcblxuICAvKiogTWVudSBUcmlnZ2VyICovXG4gIEBJbnB1dCgpXG4gIHNldCByZWYodmFsdWU6IEx5TWVudVRyaWdnZXJGb3IpIHtcbiAgICB0aGlzLl9yZWYgPSB2YWx1ZTtcbiAgICB0aGlzLl9tZW51UmVmID0gdmFsdWUuX21lbnVSZWYhO1xuICB9XG4gIGdldCByZWYoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlZjtcbiAgfVxuXG4gIC8qKiBXaGV0aGVyIHRoZSBtZW51IGhhcyBhIGJhY2tkcm9wLiAqL1xuICBASW5wdXQoKVxuICBnZXQgaGFzQmFja2Ryb3AoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2hhc0JhY2tkcm9wO1xuICB9XG4gIHNldCBoYXNCYWNrZHJvcCh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2hhc0JhY2tkcm9wID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgX3RoZW1lOiBMeVRoZW1lMixcbiAgICBwcml2YXRlIF9lbDogRWxlbWVudFJlZixcbiAgICBwcml2YXRlIF9yZW5kZXJlcjogUmVuZGVyZXIyLFxuICAgIHByaXZhdGUgX3ZpZXdwb3J0UnVsZXI6IFZpZXdwb3J0UnVsZXIsXG4gICAgcmVhZG9ubHkgc1JlbmRlcmVyOiBTdHlsZVJlbmRlcmVyXG4gICkgeyB9XG5cbiAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgc3RhdGljIHJlYWRvbmx5INC4ID0gJ0x5TWVudSc7XG5cblxuICBzdGF0aWMgbmdBY2NlcHRJbnB1dFR5cGVfaGFzQmFja2Ryb3A6IEJvb2xlYW5JbnB1dDtcblxuICAvKipcbiAgICogc3R5bGVzXG4gICAqIEBkb2NzLXByaXZhdGVcbiAgICovXG4gIHJlYWRvbmx5IGNsYXNzZXMgPSB0aGlzLnNSZW5kZXJlci5yZW5kZXJTaGVldChTVFlMRVMsIHRydWUpO1xuXG4gIC8qKiBXaGV0aGVyIHRoZSBtZW51IGlzIGFuaW1hdGluZy4gKi9cbiAgX2lzQW5pbWF0aW5nOiBib29sZWFuO1xuXG4gIC8qKiBXaGV0aGVyIHRoZSBtZW51IGlzIGRlc3Ryb3lpbmcuICovXG4gIF9pc0Rlc3Ryb3lpbmc6IGJvb2xlYW47XG5cbiAgLyoqIEVtaXRzIHdoZW5ldmVyIGFuIGFuaW1hdGlvbiBvbiB0aGUgbWVudSBjb21wbGV0ZXMuICovXG4gIF9hbmltYXRpb25Eb25lID0gbmV3IFN1YmplY3Q8QW5pbWF0aW9uRXZlbnQ+KCk7XG5cbiAgcHJpdmF0ZSBfbWVudVJlZjogT3ZlcmxheUZhY3Rvcnk8YW55PjtcbiAgLyoqXG4gICAqIERlc3Ryb3kgbWVudVxuICAgKiBAZG9jcy1wcml2YXRlXG4gICAqL1xuICBkZXN0cm95OiAoKSA9PiB2b2lkO1xuICBAVmlld0NoaWxkKCdjb250YWluZXInKSBfY29udGFpbmVyPzogRWxlbWVudFJlZjxIVE1MRGl2RWxlbWVudD47XG4gIEBDb250ZW50Q2hpbGRyZW4oZm9yd2FyZFJlZigoKSA9PiBMeU1lbnVJdGVtKSkgcmVhZG9ubHkgbWVudUl0ZW1zPzogUXVlcnlMaXN0PEx5TWVudUl0ZW0+O1xuICBwcml2YXRlIF9yZWY6IEx5TWVudVRyaWdnZXJGb3I7XG5cbiAgLyoqIFRoZSBwb2ludCBpbiB0aGUgYW5jaG9yIHdoZXJlIHRoZSBtZW51IGB4QXhpc2Agd2lsbCBiZSBhdHRhY2hlZC4gKi9cbiAgQElucHV0KCkgeEFuY2hvcjogWFBvc2l0aW9uO1xuXG4gIC8qKiBUaGUgcG9pbnQgaW4gdGhlIGFuY2hvciB3aGVyZSB0aGUgbWVudSBgeUF4aXNgIHdpbGwgYmUgYXR0YWNoZWQuICovXG4gIEBJbnB1dCgpIHlBbmNob3I6IFlQb3NpdGlvbjtcblxuICAvKiogVGhlIHgtYXhpcyBwb3NpdGlvbiBvZiB0aGUgbWVudS4gKi9cbiAgQElucHV0KCkgeEF4aXM6IFhQb3NpdGlvbjtcblxuICAvKiogVGhlIHktYXhpcyBwb3NpdGlvbiBvZiB0aGUgbWVudS4gKi9cbiAgQElucHV0KCkgeUF4aXM6IFlQb3NpdGlvbjtcblxuICAvKipcbiAgICogUG9zaXRpb24gd2hlcmUgdGhlIG1lbnUgd2lsbCBiZSBwbGFjZWQuXG4gICAqIEBkZXByZWNhdGVkIFVzZSBgeEF4aXNgIGFuZGAgeUF4aXNgIHRvZ2V0aGVyIGluc3RlYWQuXG4gICAqL1xuICBASW5wdXQoKSBwbGFjZW1lbnQ6IFBsYWNlbWVudDtcblxuXG4gIC8qKlxuICAgKiBUaGUgeC1heGlzIHBvc2l0aW9uIG9mIHRoZSBtZW51LlxuICAgKiBAZGVwcmVjYXRlZCBVc2UgYHhBeGlzYCBpbnN0ZWFkLlxuICAgKi9cbiAgQElucHV0KCkgeFBvc2l0aW9uOiBYUG9zaXRpb247XG5cbiAgLyoqXG4gICAqIFRoZSB5LWF4aXMgcG9zaXRpb24gb2YgdGhlIG1lbnUuXG4gICAqIEBkZXByZWNhdGVkIFVzZSBgeUF4aXNgIGluc3RlYWQuXG4gICAqL1xuICBASW5wdXQoKSB5UG9zaXRpb246IFlQb3NpdGlvbjtcbiAgcHJpdmF0ZSBfaGFzQmFja2Ryb3A6IGJvb2xlYW4gPSB0cnVlO1xuICBwcml2YXRlIF9tb3VzZWVudGVyTGlzdGVuPzogKCkgPT4gdm9pZDtcbiAgcHJpdmF0ZSBfbW91c2VsZWF2ZUxpc3Rlbj86ICgpID0+IHZvaWQ7XG5cbiAgQEhvc3RCaW5kaW5nKCdAdHJhbnNmb3JtTWVudUxlYXZlJykgdHJhbnNmb3JtTWVudUxlYXZlOiB1bmtub3duO1xuXG4gIG5nT25DaGFuZ2VzKCkge1xuICAgIGlmICh0aGlzLnJlZj8uX21lbnVSZWYgJiYgdGhpcy5fY29udGFpbmVyKSB7XG4gICAgICAvLyBVcGRhdGUgYmFja2Ryb3BcbiAgICAgIHRoaXMucmVmLl9tZW51UmVmLnVwZGF0ZUJhY2tkcm9wKHRoaXMucmVmLl9pc0l0ZW1TdWJNZW51VHJpZ2dlcigpID8gZmFsc2UgOiB0aGlzLmhhc0JhY2tkcm9wKTtcbiAgICAgIHRoaXMuX3VwZGF0ZVBsYWNlbWVudCgpO1xuICAgICAgdGhpcy5fY2hlY2tCYWNrZHJvcEFuZE9wZW5PbkhvdmVyKCk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgaWYgKCF0aGlzLnJlZikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdMeU1lbnU6IHJlcXVpcmUgQElucHV0KCkgcmVmJyk7XG4gICAgfVxuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIGlmICh0aGlzLnJlZi5fbWVudVJlZikge1xuICAgICAgdGhpcy5yZWYuX21lbnVSZWYub25SZXNpemVTY3JvbGwgPSB0aGlzLl91cGRhdGVQbGFjZW1lbnQuYmluZCh0aGlzKTtcbiAgICAgIHRoaXMucmVmLl9tZW51UmVmLnVwZGF0ZUJhY2tkcm9wKHRoaXMucmVmLl9pc0l0ZW1TdWJNZW51VHJpZ2dlcigpID8gZmFsc2UgOiB0aGlzLmhhc0JhY2tkcm9wKTtcbiAgICAgIHRoaXMuX2NoZWNrQmFja2Ryb3BBbmRPcGVuT25Ib3ZlcigpO1xuICAgIH1cbiAgICB0aGlzLl91cGRhdGVQbGFjZW1lbnQoKTtcbiAgICB0aGlzLnJlZi5tZW51T3BlbmVkLmVtaXQoKTtcbiAgICBQcm9taXNlLnJlc29sdmUobnVsbCkudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLnJlZi5fc2V0TWVudU9wZW5Ub1RydWUoKTtcbiAgICB9KTtcbiAgICBjb25zdCBob3N0VHJpZ2dlciA9IHRoaXMuX2dldEhvc3RNZW51VHJpZ2dlcigpO1xuICAgIGhvc3RUcmlnZ2VyLl9tZW51RGV0YWNoZWRcbiAgICAgIC5waXBlKHRha2UoMSkpXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHRoaXMuX3JlZi5jbG9zZU1lbnUoKSk7XG4gICAgdGhpcy5fYWRkT3Blbk9uSG92ZXIoKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMuX3JlbW92ZU9wZW5PbkhvdmVyTGlzdGVuZXJzKCk7XG4gIH1cblxuICBwcml2YXRlIF9jaGVja0JhY2tkcm9wQW5kT3Blbk9uSG92ZXIoKSB7XG4gICAgY29uc3QgaG9zdFRyaWdnZXIgPSB0aGlzLl9nZXRIb3N0TWVudVRyaWdnZXIoKTtcbiAgICBpZiAodGhpcy5oYXNCYWNrZHJvcCAmJiBob3N0VHJpZ2dlci5fbWVudU9wZW5PbkhvdmVyUmVmPy5vcGVuT25Ib3Zlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGAke0x5TWVudS7QuH06IENhbid0IHVzZSBbaGFzQmFja2Ryb3BdIHdpdGggW29wZW5PbkhvdmVyXSBhdCB0aGUgc2FtZSB0aW1lLCBzZXQgW2hhc0JhY2tkcm9wXSB0byBmYWxzZSB0byB1c2UgW29wZW5PbkhvdmVyXWApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX2dldEhvc3RNZW51VHJpZ2dlcigpIHtcbiAgICBsZXQgbWVudVRyaWdnZXIgPSB0aGlzLnJlZjtcblxuICAgIHdoaWxlIChtZW51VHJpZ2dlci5fbWVudT8ucmVmKSB7XG4gICAgICBtZW51VHJpZ2dlciA9IG1lbnVUcmlnZ2VyLl9tZW51LnJlZjtcbiAgICB9XG5cbiAgICByZXR1cm4gbWVudVRyaWdnZXI7XG4gIH1cblxuICBwcml2YXRlIF9hZGRPcGVuT25Ib3ZlcigpIHtcbiAgICBjb25zdCBob3N0VHJpZ2dlciA9IHRoaXMuX2dldEhvc3RNZW51VHJpZ2dlcigpO1xuICAgIGlmIChob3N0VHJpZ2dlci5fbWVudU9wZW5PbkhvdmVyUmVmPy5vcGVuT25Ib3ZlciAmJiAhdGhpcy5fbW91c2VlbnRlckxpc3RlbiAmJiAhdGhpcy5fbW91c2VsZWF2ZUxpc3Rlbikge1xuICAgICAgaG9zdFRyaWdnZXIuX21lbnVPcGVuT25Ib3ZlclJlZiEuX2hhbmRsZU1vdXNlRW50ZXJPckxlYXZlKHRydWUpO1xuICAgICAgdGhpcy5fbW91c2VlbnRlckxpc3RlbiA9IHRoaXMuX3JlbmRlcmVyXG4gICAgICAgIC5saXN0ZW4oXG4gICAgICAgICAgdGhpcy5fZWwubmF0aXZlRWxlbWVudCxcbiAgICAgICAgICAnbW91c2VlbnRlcicsXG4gICAgICAgICAgKCkgPT4gaG9zdFRyaWdnZXIuX21lbnVPcGVuT25Ib3ZlclJlZiEuX2hhbmRsZU1vdXNlRW50ZXJPckxlYXZlKHRydWUpXG4gICAgICAgICk7XG5cbiAgICAgIHRoaXMuX21vdXNlbGVhdmVMaXN0ZW4gPSB0aGlzLl9yZW5kZXJlclxuICAgICAgICAubGlzdGVuKFxuICAgICAgICAgIHRoaXMuX2VsLm5hdGl2ZUVsZW1lbnQsXG4gICAgICAgICAgJ21vdXNlbGVhdmUnLFxuICAgICAgICAgICgpID0+IGhvc3RUcmlnZ2VyLl9tZW51T3Blbk9uSG92ZXJSZWYhLl9oYW5kbGVNb3VzZUVudGVyT3JMZWF2ZShmYWxzZSlcbiAgICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKiogUmVtb3ZlIGxpc3RlbmVycyAqL1xuICBwcml2YXRlIF9yZW1vdmVPcGVuT25Ib3Zlckxpc3RlbmVycygpIHtcbiAgICBpZiAodGhpcy5fbW91c2VlbnRlckxpc3Rlbikge1xuICAgICAgdGhpcy5fbW91c2VlbnRlckxpc3RlbigpO1xuICAgIH1cbiAgICBpZiAodGhpcy5fbW91c2VsZWF2ZUxpc3Rlbikge1xuICAgICAgdGhpcy5fbW91c2VsZWF2ZUxpc3RlbigpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBVcGRhdGUgTWVudSBQb3NpdGlvbiAqL1xuICBwcml2YXRlIF91cGRhdGVQbGFjZW1lbnQoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLnJlZi5fbWVudVJlZj8uY29udGFpbmVyRWxlbWVudDtcbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLl9jb250YWluZXI/Lm5hdGl2ZUVsZW1lbnQ7XG5cbiAgICAvLyBEbyBub3QgdXBkYXRlIHdoZW4gbm90IGF2YWlsYWJsZVxuICAgIGlmICghZWwgfHwgIWNvbnRhaW5lcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIHJlc2V0IGhlaWdodCAmIHdpZHRoXG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoY29udGFpbmVyLCAnaGVpZ2h0JywgJ2luaXRpYWwnKTtcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShjb250YWluZXIsICd3aWR0aCcsICdpbml0aWFsJyk7XG5cbiAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMucGxhY2VtZW50XG4gICAgICA/IG5ldyBQb3NpdGlvbmluZyh0aGlzLnBsYWNlbWVudCwgdGhpcy54UG9zaXRpb24sIHRoaXMueVBvc2l0aW9uLCB0aGlzLnJlZi5fZ2V0SG9zdEVsZW1lbnQoKSwgZWwsIHRoaXMuX3RoZW1lLnZhcmlhYmxlcylcbiAgICAgIDogIXRoaXMucmVmLl9pc0l0ZW1TdWJNZW51VHJpZ2dlcigpXG4gICAgICAgID8gbmV3IEx5T3ZlcmxheVBvc2l0aW9uKHRoaXMuX3RoZW1lLCB0aGlzLl92aWV3cG9ydFJ1bGVyLCB0aGlzLnJlZi5fZ2V0SG9zdEVsZW1lbnQoKSwgZWwpXG4gICAgICAgICAgLnNldFhBbmNob3IodGhpcy54QW5jaG9yKVxuICAgICAgICAgIC5zZXRZQW5jaG9yKHRoaXMueUFuY2hvcilcbiAgICAgICAgICAuc2V0WEF4aXModGhpcy54QXhpcylcbiAgICAgICAgICAuc2V0WUF4aXModGhpcy55QXhpcylcbiAgICAgICAgICAuc2V0RmxpcCh0cnVlKVxuICAgICAgICAgIC5idWlsZCgpXG4gICAgICAgIDogbmV3IEx5T3ZlcmxheVBvc2l0aW9uKHRoaXMuX3RoZW1lLCB0aGlzLl92aWV3cG9ydFJ1bGVyLCB0aGlzLnJlZi5fZ2V0SG9zdEVsZW1lbnQoKSwgZWwpXG4gICAgICAgICAgLnNldFhBbmNob3IoWFBvc2l0aW9uLmFmdGVyKVxuICAgICAgICAgIC5zZXRZQW5jaG9yKFlQb3NpdGlvbi5hYm92ZSlcbiAgICAgICAgICAuc2V0RmxpcCh0cnVlKVxuICAgICAgICAgIC5idWlsZCgpO1xuXG4gICAgaWYgKHBvc2l0aW9uIGluc3RhbmNlb2YgUG9zaXRpb25pbmcpIHtcbiAgICAgIC8vIHNldCBwb3NpdGlvbiBkZXByZWNhdGVkXG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShlbCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgke3Bvc2l0aW9uLnh9cHgsICR7cG9zaXRpb24ueX1weCwgMClgKTtcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuX2VsLm5hdGl2ZUVsZW1lbnQsICd0cmFuc2Zvcm0tb3JpZ2luJywgYCR7cG9zaXRpb24ub3h9ICR7cG9zaXRpb24ub3l9IDBgKTtcblxuICAgICAgLy8gc2V0IGhlaWdodCAmIHdpZHRoIGRlcHJlY2F0ZWRcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGNvbnRhaW5lciwgJ2hlaWdodCcsIHBvc2l0aW9uLmhlaWdodCA9PT0gJ2luaXRpYWwnID8gJzEwMCUnIDogcG9zaXRpb24uaGVpZ2h0KTtcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGNvbnRhaW5lciwgJ3dpZHRoJywgcG9zaXRpb24ud2lkdGggPT09ICdpbml0aWFsJyA/ICcxMDAlJyA6IHBvc2l0aW9uLndpZHRoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gc2V0IHBvc2l0aW9uXG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShlbCwgJ2xlZnQnLCBgJHtwb3NpdGlvbi54fXB4YCk7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShlbCwgJ3RvcCcsIGAke3Bvc2l0aW9uLnl9cHhgKTtcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGNvbnRhaW5lciwgJ3dpZHRoJywgcG9zaXRpb24ud2lkdGggPyBgJHtwb3NpdGlvbi53aWR0aH1weGAgOiAnMTAwJScpO1xuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoY29udGFpbmVyLCAnaGVpZ2h0JywgcG9zaXRpb24uaGVpZ2h0ID8gYCR7cG9zaXRpb24uaGVpZ2h0fXB4YCA6ICcxMDAlJyk7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9lbC5uYXRpdmVFbGVtZW50LCAndHJhbnNmb3JtLW9yaWdpbicsIGAke3Bvc2l0aW9uLnhvfXB4ICR7cG9zaXRpb24ueW99cHggMGApO1xuICAgIH1cblxuICB9XG4gIEBIb3N0TGlzdGVuZXIoJ0B0cmFuc2Zvcm1NZW51TGVhdmUuc3RhcnQnLCBbJyRldmVudCddKSBfb25BbmltYXRpb25TdGFydChldmVudDogQW5pbWF0aW9uRXZlbnQpIHtcbiAgICB0aGlzLl9pc0FuaW1hdGluZyA9IHRydWU7XG4gICAgaWYgKGV2ZW50LnRyaWdnZXJOYW1lID09PSAndHJhbnNmb3JtTWVudUxlYXZlJyAmJiBldmVudC50b1N0YXRlID09PSAndm9pZCcpIHtcbiAgICAgIHRoaXMuX2lzRGVzdHJveWluZyA9IHRydWU7XG4gICAgfVxuICB9XG4gIEBIb3N0TGlzdGVuZXIoJ0B0cmFuc2Zvcm1NZW51TGVhdmUuZG9uZScsIFsnJGV2ZW50J10pIF9vbkFuaW1hdGlvbkRvbmUoZXZlbnQ6IEFuaW1hdGlvbkV2ZW50KSB7XG4gICAgdGhpcy5fYW5pbWF0aW9uRG9uZS5uZXh0KGV2ZW50KTtcbiAgICB0aGlzLl9pc0FuaW1hdGluZyA9IGZhbHNlO1xuICAgIGlmIChldmVudC50b1N0YXRlID09PSAndm9pZCcgJiYgZXZlbnQudHJpZ2dlck5hbWUgPT09ICd0cmFuc2Zvcm1NZW51TGVhdmUnKSB7XG4gICAgICB0aGlzLnJlZi5kZXN0cm95KHRoaXMuX21lbnVSZWYpO1xuICAgIH1cbiAgfVxufVxuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbbHktbWVudS1pdGVtXScsXG4gIGhvc3Q6IHtcbiAgICAnKGNsaWNrKSc6ICdfaGFuZGxlQ2xpY2soKScsXG4gICAgJyhtb3VzZWVudGVyKSc6ICdfaGFuZGxlTW91c2VFbnRlcigpJ1xuICB9XG59KVxuZXhwb3J0IGNsYXNzIEx5TWVudUl0ZW0ge1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgX21lbnU6IEx5TWVudSxcbiAgICBlbDogRWxlbWVudFJlZixcbiAgICByZW5kZXJlcjogUmVuZGVyZXIyXG4gICkge1xuICAgIHJlbmRlcmVyLmFkZENsYXNzKGVsLm5hdGl2ZUVsZW1lbnQsIF9tZW51LmNsYXNzZXMuaXRlbSk7XG4gIH1cbiAgcHJpdmF0ZSBfaXRlbVN1Yk1lbnVUcmlnZ2VyPzogTHlNZW51VHJpZ2dlckZvcjtcblxuICBfaGFuZGxlQ2xpY2soKSB7XG4gICAgaWYgKHRoaXMuX21lbnUucmVmICYmIHRoaXMuX21lbnUucmVmLl9tZW51UmVmKSB7XG4gICAgICBpZiAoIXRoaXMuX2dldEl0ZW1TdWJNZW51VHJpZ2dlcigpKSB7XG4gICAgICAgIGxldCBjdXJyZW50VHJpZ2dlciA9IHRoaXMuX21lbnUucmVmO1xuICAgICAgICB3aGlsZSAoY3VycmVudFRyaWdnZXIpIHtcbiAgICAgICAgICBjdXJyZW50VHJpZ2dlci5jbG9zZU1lbnUoKTtcbiAgICAgICAgICBjdXJyZW50VHJpZ2dlciA9IGN1cnJlbnRUcmlnZ2VyLl9tZW51Py5yZWY7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfaGFuZGxlTW91c2VFbnRlcigpIHtcbiAgICBjb25zdCBpdGVtU3ViTWVudVRyaWdnZXIgPSB0aGlzLl9nZXRJdGVtU3ViTWVudVRyaWdnZXIoKTtcbiAgICBpZiAoaXRlbVN1Yk1lbnVUcmlnZ2VyICYmICF0aGlzLl9tZW51Ll9pc0Rlc3Ryb3lpbmcpIHtcbiAgICAgIGlmICh0aGlzLl9tZW51Ll9pc0FuaW1hdGluZykge1xuICAgICAgICB0aGlzLl9tZW51Ll9hbmltYXRpb25Eb25lXG4gICAgICAgIC5waXBlKHRha2UoMSksIGRlbGF5KDAsIGFzYXBTY2hlZHVsZXIpKVxuICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICBpdGVtU3ViTWVudVRyaWdnZXIub3Blbk1lbnUoKTtcbiAgICAgICAgICB0aGlzLl9jbG9zZU90aGVyTWVudXMoKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpdGVtU3ViTWVudVRyaWdnZXIub3Blbk1lbnUoKTtcbiAgICAgICAgdGhpcy5fY2xvc2VPdGhlck1lbnVzKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2Nsb3NlT3RoZXJNZW51cygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBFeGNlcHQgZm9yIHRoaXMsIGNsb3NlIGFsbCBtZW51cyAqL1xuICBwcml2YXRlIF9jbG9zZU90aGVyTWVudXMoKSB7XG4gICAgdGhpcy5fbWVudS5tZW51SXRlbXMhLmZvckVhY2gobWVudUl0ZW0gPT4ge1xuICAgICAgaWYgKG1lbnVJdGVtICE9PSB0aGlzKSB7XG4gICAgICAgIG1lbnVJdGVtLl9nZXRJdGVtU3ViTWVudVRyaWdnZXIoKT8uY2xvc2VNZW51KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBfc2V0SXRlbVN1Yk1lbnVUcmlnZ2VyKG1lbnVUcmlnZ2VyOiBMeU1lbnVUcmlnZ2VyRm9yKSB7XG4gICAgdGhpcy5faXRlbVN1Yk1lbnVUcmlnZ2VyID0gbWVudVRyaWdnZXI7XG4gIH1cbiAgX2dldEl0ZW1TdWJNZW51VHJpZ2dlcigpIHtcbiAgICByZXR1cm4gdGhpcy5faXRlbVN1Yk1lbnVUcmlnZ2VyO1xuICB9XG59XG5cblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiAnW2x5TWVudVRyaWdnZXJGb3JdJyxcbiAgaG9zdDoge1xuICAgICcoY2xpY2spJzogJ19oYW5kbGVDbGljaygpJ1xuICB9LFxuICBleHBvcnRBczogJ2x5TWVudVRyaWdnZXJGb3InLFxuICBwcm92aWRlcnM6IFtcbiAgICBTdHlsZVJlbmRlcmVyXG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgTHlNZW51VHJpZ2dlckZvciBpbXBsZW1lbnRzIE9uRGVzdHJveSB7XG4gIHJlYWRvbmx5IGNsYXNzZXMgPSB0aGlzLnNSZW5kZXJlci5yZW5kZXJTaGVldChTVFlMRVMpO1xuXG4gIC8qKiBDdXJyZW50IG1lbnVSZWYgKi9cbiAgX21lbnVSZWY/OiBPdmVybGF5RmFjdG9yeSB8IG51bGw7XG4gIHByaXZhdGUgX21lbnVPcGVuID0gZmFsc2U7XG4gIHByaXZhdGUgX2Rlc3Ryb3lpbmc6IGJvb2xlYW47XG4gIF9tZW51RGV0YWNoZWQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuICBfbWVudU9wZW5PbkhvdmVyUmVmPzogTHlNZW51T3Blbk9uSG92ZXI7XG5cbiAgLyoqIFdoZXRoZXIgdGhlIG1lbnUgaXMgb3Blbi4gKi9cbiAgZ2V0IG1lbnVPcGVuKCkge1xuICAgIHJldHVybiB0aGlzLl9tZW51T3BlbjtcbiAgfVxuXG4gIEBJbnB1dCgpIGx5TWVudVRyaWdnZXJGb3I6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgLyoqIERhdGEgdG8gYmUgcGFzc2VkIHRvIHRoZSBtZW51LiAqL1xuICBASW5wdXQoJ2x5TWVudVRyaWdnZXJEYXRhJykgbWVudURhdGE6IGFueTtcblxuICBAT3V0cHV0KCkgcmVhZG9ubHkgbWVudU9wZW5lZCA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcbiAgQE91dHB1dCgpIHJlYWRvbmx5IG1lbnVDbG9zZWQgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgb3ZlcmxheTogTHlPdmVybGF5LFxuICAgIEBPcHRpb25hbCgpIHByaXZhdGUgX21lbnVJdGVtOiBMeU1lbnVJdGVtLFxuICAgIHJlYWRvbmx5IHNSZW5kZXJlcjogU3R5bGVSZW5kZXJlcixcbiAgICBAT3B0aW9uYWwoKSBwdWJsaWMgX21lbnU6IEx5TWVudVxuICApIHtcbiAgICBpZiAodGhpcy5faXNJdGVtU3ViTWVudVRyaWdnZXIoKSkge1xuICAgICAgX21lbnVJdGVtLl9zZXRJdGVtU3ViTWVudVRyaWdnZXIodGhpcyk7XG4gICAgICBzUmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5jbGFzc2VzLml0ZW1TdWJNZW51VHJpZ2dlcik7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgLy8gTm90IGZvcmNlIGRlc3RydWN0aW9uIGlmIGl0IGlzIGFscmVhZHkgYmVpbmcgZGVzdHJveWVkXG4gICAgaWYgKCF0aGlzLl9kZXN0cm95aW5nKSB7XG4gICAgICB0aGlzLmNsb3NlTWVudSgpO1xuICAgIH1cbiAgICB0aGlzLl9tZW51RGV0YWNoZWQuY29tcGxldGUoKTtcbiAgfVxuXG4gIF9oYW5kbGVDbGljaygpIHtcbiAgICBpZiAoIXRoaXMuX2lzSXRlbVN1Yk1lbnVUcmlnZ2VyKCkpIHtcbiAgICAgIHRoaXMudG9nZ2xlTWVudSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBPcGVucyB0aGUgbWVudSAqL1xuICBvcGVuTWVudSgpIHtcbiAgICBpZiAoIXRoaXMuX21lbnVSZWYpIHtcbiAgICAgIHRoaXMuX21lbnVSZWYgPSB0aGlzLm92ZXJsYXkuY3JlYXRlKHRoaXMubHlNZW51VHJpZ2dlckZvciwge1xuICAgICAgICAkaW1wbGljaXQ6IHRoaXMsXG4gICAgICAgIGRhdGE6IHRoaXMubWVudURhdGFcbiAgICAgIH0sIHtcbiAgICAgICAgc3R5bGVzOiB7XG4gICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgcG9pbnRlckV2ZW50czogbnVsbFxuICAgICAgICB9LFxuICAgICAgICBmbkRlc3Ryb3k6IHRoaXMuZGV0YWNoLmJpbmQodGhpcyksXG4gICAgICAgIGhhc0JhY2tkcm9wOiBmYWxzZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqIENsb3NlcyB0aGUgbWVudSAqL1xuICBjbG9zZU1lbnUoKSB7XG4gICAgdGhpcy5kZXRhY2goKTtcbiAgfVxuXG4gIC8qKiBUb2dnbGUgbWVudSAqL1xuICB0b2dnbGVNZW51KCkge1xuICAgIGlmICh0aGlzLl9tZW51UmVmKSB7XG4gICAgICB0aGlzLmNsb3NlTWVudSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9wZW5NZW51KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgZGV0YWNoKCkge1xuICAgIGlmICh0aGlzLl9tZW51UmVmKSB7XG4gICAgICB0aGlzLl9tZW51UmVmLmRldGFjaCgpO1xuICAgICAgdGhpcy5fbWVudVJlZiA9IG51bGw7XG4gICAgICB0aGlzLl9kZXN0cm95aW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMuX21lbnVEZXRhY2hlZC5uZXh0KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgZGVzdHJveShtZW51UmVmOiBPdmVybGF5RmFjdG9yeTxhbnk+KSB7XG4gICAgdGhpcy5tZW51Q2xvc2VkLmVtaXQobnVsbCEpO1xuICAgIG1lbnVSZWYucmVtb3ZlKCk7XG4gICAgdGhpcy5fZGVzdHJveWluZyA9IGZhbHNlO1xuICAgIFByb21pc2UucmVzb2x2ZShudWxsKS50aGVuKCgpID0+IHRoaXMuX21lbnVPcGVuID0gZmFsc2UpO1xuICB9XG5cbiAgX2dldEhvc3RFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcbiAgfVxuXG4gIF9zZXRNZW51T3BlblRvVHJ1ZSgpIHtcbiAgICB0aGlzLl9tZW51T3BlbiA9IHRydWU7XG4gIH1cblxuICAvKipcbiAgICogQGRvY3MtcHJpdmF0ZVxuICAgKi9cbiAgX2lzSXRlbVN1Yk1lbnVUcmlnZ2VyKCkge1xuICAgIHJldHVybiAhIXRoaXMuX21lbnVJdGVtO1xuICB9XG5cbn1cblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiAnW2x5TWVudVRyaWdnZXJGb3JdW29wZW5PbkhvdmVyXScsXG4gIGhvc3Q6IHtcbiAgICAnKG1vdXNlZW50ZXIpJzogJ19oYW5kbGVNb3VzZUVudGVyT3JMZWF2ZSh0cnVlKScsXG4gICAgJyhtb3VzZWxlYXZlKSc6ICdfaGFuZGxlTW91c2VFbnRlck9yTGVhdmUoZmFsc2UpJ1xuICB9XG59KVxuZXhwb3J0IGNsYXNzIEx5TWVudU9wZW5PbkhvdmVyIGltcGxlbWVudHMgT25EZXN0cm95IHtcblxuICBwcml2YXRlIF9ldmVudHMgPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuXG4gIC8qKiBXaGV0aGVyIG1lbnUgc2hvdWxkIG9wZW4gb24gaG92ZXIuICovXG4gIEBJbnB1dCgpXG4gIGdldCBvcGVuT25Ib3ZlcigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fb3Blbk9uSG92ZXI7XG4gIH1cbiAgc2V0IG9wZW5PbkhvdmVyKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5fb3Blbk9uSG92ZXIgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkodmFsdWUpO1xuICAgIFByb21pc2UucmVzb2x2ZShudWxsKVxuICAgIC50aGVuKCgpID0+IHRoaXMuX29wZW5PbkhvdmVyXG4gICAgICA/IHRoaXMuX3RyaWdnZXIuX21lbnVPcGVuT25Ib3ZlclJlZiA9IHRoaXNcbiAgICAgIDogZGVsZXRlIHRoaXMuX3RyaWdnZXIuX21lbnVPcGVuT25Ib3ZlclJlZik7XG4gIH1cbiAgcHJpdmF0ZSBfb3Blbk9uSG92ZXI6IGJvb2xlYW4gPSB0cnVlO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgX3RyaWdnZXI6IEx5TWVudVRyaWdnZXJGb3JcbiAgKSB7XG4gICAgX3RyaWdnZXIuX21lbnVPcGVuT25Ib3ZlclJlZiA9IHRoaXM7XG4gICAgdGhpcy5fZXZlbnRzXG4gICAgICAucGlwZShcbiAgICAgICAgZGVib3VuY2VUaW1lKDIwMClcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoZW50ZXJPckxlYXZlID0+IHtcbiAgICAgICAgaWYgKHRoaXMub3Blbk9uSG92ZXIpIHtcbiAgICAgICAgICBpZiAoZW50ZXJPckxlYXZlKSB7XG4gICAgICAgICAgICBfdHJpZ2dlci5vcGVuTWVudSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfdHJpZ2dlci5jbG9zZU1lbnUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5fZXZlbnRzLmNvbXBsZXRlKCk7XG4gIH1cblxuICAvKiogSGFuZGxlIG1vdXNlZW50ZXIgKi9cbiAgX2hhbmRsZU1vdXNlRW50ZXJPckxlYXZlKGVudGVyOiB0cnVlKTogdm9pZDtcbiAgLyoqIEhhbmRsZSBtb3VzZWxlYXZlICovXG4gIF9oYW5kbGVNb3VzZUVudGVyT3JMZWF2ZShsZWF2ZTogZmFsc2UpOiB2b2lkO1xuICAvKiogSGFuZGxlIG1vdXNlZW50ZXIgb3IgbW91c2VsZWF2ZSAqL1xuICBfaGFuZGxlTW91c2VFbnRlck9yTGVhdmUobGVhdmVPckVudGVyOiBib29sZWFuKTogdm9pZCB7XG4gICAgaWYgKHRoaXMub3Blbk9uSG92ZXIpIHtcbiAgICAgIGlmIChsZWF2ZU9yRW50ZXIpIHtcbiAgICAgICAgdGhpcy5fdHJpZ2dlci5vcGVuTWVudSgpO1xuICAgICAgfVxuICAgICAgdGhpcy5fZXZlbnRzLm5leHQobGVhdmVPckVudGVyKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==