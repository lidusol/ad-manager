import { ReplaySubject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
function componentDestroyed(component) {
    const modifiedComponent = component;
    if (modifiedComponent.__componentDestroyed$) {
        return modifiedComponent.__componentDestroyed$;
    }
    const oldNgOnDestroy = component.ngOnDestroy;
    const stop$ = new ReplaySubject();
    modifiedComponent.ngOnDestroy = function () {
        if (oldNgOnDestroy) {
            oldNgOnDestroy.apply(component);
        }
        stop$.next();
        stop$.complete();
    };
    return modifiedComponent.__componentDestroyed$ = stop$.asObservable();
}
export function untilComponentDestroyed(component) {
    return (source) => source.pipe(takeUntil(componentDestroyed(component)));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LWRlc3Ryb3llZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL2xpYi9zcmMvbWluaW1hbC9jb21wb25lbnQtZGVzdHJveWVkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBYyxhQUFhLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDakQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTNDLFNBQVMsa0JBQWtCLENBQUMsU0FBb0I7SUFDNUMsTUFBTSxpQkFBaUIsR0FBRyxTQUd6QixDQUFDO0lBQ0YsSUFBSSxpQkFBaUIsQ0FBQyxxQkFBcUIsRUFBRTtRQUN6QyxPQUFPLGlCQUFpQixDQUFDLHFCQUFxQixDQUFDO0tBQ2xEO0lBQ0QsTUFBTSxjQUFjLEdBQUcsU0FBUyxDQUFDLFdBQVcsQ0FBQztJQUM3QyxNQUFNLEtBQUssR0FBRyxJQUFJLGFBQWEsRUFBUSxDQUFDO0lBQ3hDLGlCQUFpQixDQUFDLFdBQVcsR0FBRztRQUM1QixJQUFJLGNBQWMsRUFBRTtZQUNsQixjQUFjLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQ2pDO1FBQ0QsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ2IsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ3JCLENBQUMsQ0FBQztJQUNGLE9BQU8saUJBQWlCLENBQUMscUJBQXFCLEdBQUcsS0FBSyxDQUFDLFlBQVksRUFBRSxDQUFDO0FBQzFFLENBQUM7QUFFRCxNQUFNLFVBQVUsdUJBQXVCLENBQUksU0FBb0I7SUFDM0QsT0FBTyxDQUFDLE1BQXFCLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLGtCQUFrQixDQUFDLFNBQXNCLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDekcsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9uRGVzdHJveSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgUmVwbGF5U3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5mdW5jdGlvbiBjb21wb25lbnREZXN0cm95ZWQoY29tcG9uZW50OiBPbkRlc3Ryb3kpOiBPYnNlcnZhYmxlPHZvaWQ+IHtcbiAgICBjb25zdCBtb2RpZmllZENvbXBvbmVudCA9IGNvbXBvbmVudCBhcyB7XG4gICAgICBfX2NvbXBvbmVudERlc3Ryb3llZCQ/OiBPYnNlcnZhYmxlPHZvaWQ+XG4gICAgICBuZ09uRGVzdHJveT8oKTogdm9pZFxuICAgIH07XG4gICAgaWYgKG1vZGlmaWVkQ29tcG9uZW50Ll9fY29tcG9uZW50RGVzdHJveWVkJCkge1xuICAgICAgICByZXR1cm4gbW9kaWZpZWRDb21wb25lbnQuX19jb21wb25lbnREZXN0cm95ZWQkO1xuICAgIH1cbiAgICBjb25zdCBvbGROZ09uRGVzdHJveSA9IGNvbXBvbmVudC5uZ09uRGVzdHJveTtcbiAgICBjb25zdCBzdG9wJCA9IG5ldyBSZXBsYXlTdWJqZWN0PHZvaWQ+KCk7XG4gICAgbW9kaWZpZWRDb21wb25lbnQubmdPbkRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKG9sZE5nT25EZXN0cm95KSB7XG4gICAgICAgICAgb2xkTmdPbkRlc3Ryb3kuYXBwbHkoY29tcG9uZW50KTtcbiAgICAgICAgfVxuICAgICAgICBzdG9wJC5uZXh0KCk7XG4gICAgICAgIHN0b3AkLmNvbXBsZXRlKCk7XG4gICAgfTtcbiAgICByZXR1cm4gbW9kaWZpZWRDb21wb25lbnQuX19jb21wb25lbnREZXN0cm95ZWQkID0gc3RvcCQuYXNPYnNlcnZhYmxlKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bnRpbENvbXBvbmVudERlc3Ryb3llZDxUPihjb21wb25lbnQ6IE9uRGVzdHJveSk6IChzb3VyY2U6IE9ic2VydmFibGU8VD4pID0+IE9ic2VydmFibGU8VD4ge1xuICAgIHJldHVybiAoc291cmNlOiBPYnNlcnZhYmxlPFQ+KSA9PiBzb3VyY2UucGlwZSh0YWtlVW50aWwoY29tcG9uZW50RGVzdHJveWVkKGNvbXBvbmVudCBhcyBPbkRlc3Ryb3kpKSk7XG59XG4iXX0=