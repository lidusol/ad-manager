{"version":3,"file":"alyle-ui-select.js","sources":["../../../lib/select/select-errors.ts","../../../lib/select/select.ts","../../../lib/select/select.module.ts","../../../lib/select/alyle-ui-select.ts"],"sourcesContent":["/**\n * Returns an exception to be thrown when attempting to assign a non-array value to a select\n * in `multiple` mode. Note that `undefined` and `null` are still valid values to allow for\n * resetting the value.\n * @docs-private\n */\nexport function getLySelectNonArrayValueError(): Error {\n  return Error('Value must be an array in multiple-selection mode.');\n}\n\n/**\n * Returns an exception to be thrown when assigning a non-function value to the comparator\n * used to determine if a value corresponds to an option. Note that whether the function\n * actually takes two values and returns a boolean is not checked.\n */\nexport function getLySelectNonFunctionValueError(): Error {\n  return Error('`compareWith` must be a function.');\n}\n","import {\n  animate,\n  keyframes,\n  style,\n  transition,\n  trigger\n  } from '@angular/animations';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  DoCheck,\n  ElementRef,\n  forwardRef,\n  HostListener,\n  Input,\n  OnDestroy,\n  OnInit,\n  Optional,\n  Renderer2,\n  Self,\n  TemplateRef,\n  ViewChild,\n  NgZone,\n  OnChanges,\n  QueryList,\n  ContentChildren,\n  AfterContentInit,\n  Directive,\n  ContentChild,\n  Output,\n  EventEmitter,\n  isDevMode,\n  } from '@angular/core';\nimport {\n  ControlValueAccessor,\n  FormGroupDirective,\n  NgControl,\n  NgForm\n  } from '@angular/forms';\nimport { LyField, LyFieldControlBase, STYLES as FIELD_STYLES } from '@alyle/ui/field';\nimport {\n  LyOverlay,\n  LyTheme2,\n  OverlayFactory,\n  shadowBuilder,\n  ThemeVariables,\n  toBoolean,\n  Positioning,\n  CanDisableCtor,\n  mixinDisableRipple,\n  mixinTabIndex,\n  LyRippleService,\n  XPosition,\n  YPosition,\n  Dir,\n  st2c,\n  StyleCollection,\n  LyClasses,\n  StyleTemplate,\n  ThemeRef,\n  StyleRenderer,\n  Style,\n  WithStyles } from '@alyle/ui';\nimport { Subject, Observable, defer, merge } from 'rxjs';\nimport { take, takeUntil, startWith, switchMap, distinctUntilChanged, filter, mapTo } from 'rxjs/operators';\nimport { Platform } from '@angular/cdk/platform';\nimport { FocusableOption, FocusOrigin, ActiveDescendantKeyManager } from '@angular/cdk/a11y';\nimport { ENTER, SPACE, hasModifierKey, DOWN_ARROW, UP_ARROW, LEFT_ARROW, RIGHT_ARROW, A } from '@angular/cdk/keycodes';\nimport { coerceNumberProperty, coerceBooleanProperty } from '@angular/cdk/coercion';\nimport { SelectionModel } from '@angular/cdk/collections';\nimport { getLySelectNonFunctionValueError, getLySelectNonArrayValueError } from './select-errors';\n\n\nexport interface LySelectTheme {\n  /** Styles for Select Component */\n  root?: StyleCollection<((classes: LyClasses<typeof STYLES>) => StyleTemplate)>\n    | ((classes: LyClasses<typeof STYLES>) => StyleTemplate);\n}\n\nexport interface LySelectVariables {\n  select?: LySelectTheme;\n}\n\nconst DEFAULT_DISABLE_RIPPLE = false;\nconst STYLE_PRIORITY = -2;\nexport const STYLES = (theme: ThemeVariables & LySelectVariables, ref: ThemeRef) => {\n  const select = ref.selectorsOf(STYLES);\n  const { after } = theme;\n  return {\n    $priority: STYLE_PRIORITY,\n    root: () => (className: string) => `${className}{display:block;position:relative;padding-${after}:1em;min-height:1em;-webkit-tap-highlight-color:transparent;}${st2c((\n          (theme.select\n            && theme.select.root\n            && (theme.select.root instanceof StyleCollection\n              ? theme.select.root.setTransformer(fn => fn(select))\n              : theme.select.root(select))\n          )), `${className}`)}`,\n    container: {\n      background: theme.background.primary.default,\n      borderRadius: '2px',\n      boxShadow: shadowBuilder(4),\n      display: 'block',\n      transformOrigin: 'inherit',\n      pointerEvents: 'all',\n      overflow: 'auto',\n      maxHeight: '256px'\n    },\n    valueText: {\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap'\n    },\n    option: {\n      display: 'flex',\n      fontFamily: theme.typography.fontFamily,\n      color: theme.text.default,\n      '-webkit-tap-highlight-color': 'transparent',\n      backgroundColor: `rgba(0, 0, 0, 0)`,\n      border: 0,\n      padding: '0 1em',\n      margin: 0,\n      outline: 'none',\n      boxSizing: 'border-box',\n      position: 'relative',\n      justifyContent: 'flex-start',\n      alignItems: 'center',\n      alignContent: 'center',\n      '-webkit-user-select': 'none',\n      '-moz-user-select': 'none',\n      '-ms-user-select': 'none',\n      userSelect: 'none',\n      lineHeight: 1.125,\n      height: '3em',\n      cursor: 'pointer',\n    },\n    optionActive: (className: string) => `${className}{background:${theme.hover};}`,\n    optionText: {\n      'ly-checkbox ~ &': {\n        display: 'flex',\n        alignItems: 'inherit',\n        alignContent: 'inherit'\n      }\n    },\n    content: {\n      padding: 0,\n      display: 'flex',\n      justifyContent: 'inherit',\n      alignItems: 'inherit',\n      alignContent: 'inherit',\n      width: '100%',\n      height: '100%',\n      boxSizing: 'border-box'\n    }\n  };\n};\n\n/** Change event object that is emitted when the select value has changed. */\nexport class LySelectChange {\n  constructor(\n    /** Reference to the select that emitted the change event. */\n    public source: LySelect,\n    /** Current value of the select that emitted the event. */\n    public value: any) { }\n}\n\n/** @docs-private */\nconst ANIMATIONS = [\n  trigger('selectEnter', [\n    transition('void => in', [\n      animate('125ms cubic-bezier(0, 0, 0.2, 1)', keyframes([\n        style({\n          opacity: 0,\n          transform: 'scaleY(0.9)'\n        }),\n        style({\n          opacity: 1,\n          transform: 'scaleY(1)'\n        })\n      ]))\n    ]),\n    transition('* => void', animate('100ms 25ms linear', style({ opacity: 0 })))\n  ]),\n];\n\n/** @docs-private */\nexport class LySelectBase { }\n/** @docs-private */\nexport const LySelectMixinBase = mixinTabIndex(LySelectBase as CanDisableCtor);\n\n/**\n * Allows the user to customize the trigger that is displayed when the select has a value.\n */\n@Directive({\n  selector: 'ly-select-trigger'\n})\nexport class LySelectTrigger { }\n\n\n@Component({\n  selector: 'ly-select',\n  templateUrl: 'select.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  exportAs: 'lySelect',\n  host: {\n    '[attr.tabindex]': 'tabIndex',\n    '(keydown)': '_handleKeydown($event)',\n    '(focus)': '_onFocus()',\n    '(blur)': '_onBlur()',\n  },\n  animations: [...ANIMATIONS],\n  inputs: ['tabIndex'],\n  providers: [\n    StyleRenderer,\n    { provide: LyFieldControlBase, useExisting: LySelect }\n  ]\n})\nexport class LySelect\n    extends LySelectMixinBase\n    implements ControlValueAccessor, LyFieldControlBase, OnInit, DoCheck, AfterContentInit, OnDestroy {\n  /** @docs-private */\n  readonly classes = this._theme.addStyleSheet(STYLES);\n  /** @internal */\n  _selectionModel: SelectionModel<LyOption>;\n  /** @internal */\n  _value: any;\n\n  /** The cached font-size of the trigger element. */\n  _triggerFontSize = 0;\n\n  private _overlayRef: OverlayFactory | null;\n  protected _disabled = false;\n  protected _required = false;\n  protected _placeholder: string;\n  readonly stateChanges: Subject<void> = new Subject<void>();\n  private _hasDisabledClass?: boolean;\n  private _errorClass?: string;\n  private _form: NgForm | FormGroupDirective | null = this._parentForm || this._parentFormGroup;\n  private _multiple: boolean;\n  private _opened: boolean;\n  private _valueKey: (opt: unknown) => unknown = same;\n  _focused: boolean = false;\n  errorState: boolean = false;\n  private _cursorClass: string;\n\n  /** Manages keyboard events for options in the panel. */\n  _keyManager: ActiveDescendantKeyManager<LyOption>;\n\n  /** Emits when the panel element is finished transforming in. */\n  _panelDoneAnimatingStream = new Subject<string>();\n\n  /** Comparison function to specify which option is displayed. Defaults to object equality. */\n  private _compareWith = (o1: any, o2: any) => o1 === o2;\n\n  /** Emits whenever the component is destroyed. */\n  private readonly _destroy = new Subject<void>();\n\n  /** Combined stream of all of the child options' change events. */\n  readonly optionSelectionChanges: Observable<LyOptionSelectionChange> = defer(() => {\n    const options = this.options;\n\n    if (options) {\n      return options.changes.pipe(\n        startWith(options),\n        switchMap(() => merge(...options.map(option => option.onSelectionChange)))\n      );\n    }\n\n    return this._ngZone.onStable\n      .pipe(take(1), switchMap(() => this.optionSelectionChanges));\n  }) as Observable<LyOptionSelectionChange>;\n\n  @ViewChild('templateRef') templateRef: TemplateRef<any>;\n  @ViewChild('valueText') valueTextDivRef: ElementRef<HTMLDivElement>;\n  /** @internal */\n  @ViewChild(forwardRef(() => LyOption)) _options: QueryList<LyOption>;\n  @ContentChildren(forwardRef(() => LyOption), { descendants: true }) options: QueryList<LyOption>;\n  @ContentChild(LySelectTrigger) customTrigger: LySelectTrigger;\n\n  /** Event emitted when the select panel has been toggled. */\n  @Output() readonly openedChange: EventEmitter<boolean> = new EventEmitter<boolean>();\n\n  /** Event emitted when the select has been opened. */\n  @Output('opened') readonly _openedStream: Observable<void> =\n      this.openedChange.pipe(filter(o => o), mapTo(null!));\n\n  /** Event emitted when the select has been closed. */\n  @Output('closed') readonly _closedStream: Observable<void> =\n      this.openedChange.pipe(filter(o => !o), mapTo(null!));\n\n  /** Event emitted when the selected value has been changed by the user. */\n  @Output() readonly selectionChange: EventEmitter<LySelectChange> = new EventEmitter<LySelectChange>();\n\n  /**\n   * Event that emits whenever the raw value of the select changes. This is here primarily\n   * to facilitate the two-way binding for the `value` input.\n   * @docs-private\n   */\n  @Output() readonly valueChange: EventEmitter<any> = new EventEmitter<any>();\n\n  /**\n   * The registered callback function called when a change event occurs on the input element.\n   */\n  onChange = (_: any) => {};\n\n  /**\n   * The registered callback function called when a blur event occurs on the input element.\n   */\n  onTouched = () => {};\n\n  _onFocus() {\n    if (!this.disabled) {\n      this._focused = true;\n      this.stateChanges.next();\n    }\n  }\n  _onBlur() {\n    this._focused = false;\n    if (!this.disabled && !this._opened) {\n      this.onTouched();\n      this._cd.markForCheck();\n      this.stateChanges.next();\n    }\n  }\n\n  /** Time to wait in milliseconds after the last keystroke before moving focus to an item. */\n  @Input()\n  get typeaheadDebounceInterval(): number { return this._typeaheadDebounceInterval; }\n  set typeaheadDebounceInterval(value: number) {\n    const newVal = coerceNumberProperty(value);\n    if (this._typeaheadDebounceInterval !== newVal && this._keyManager) {\n      this._typeaheadDebounceInterval = newVal;\n      this._keyManager.withTypeAhead(newVal);\n    }\n  }\n  private _typeaheadDebounceInterval: number;\n\n  /** Value of the select control. */\n  @Input()\n  get value(): any { return this._value; }\n  set value(newValue: any) {\n    if (newValue !== this._value) {\n      if (this.options) {\n        this._setSelectionByValue(newValue);\n      }\n\n      this._value = newValue;\n    }\n  }\n\n  /** Whether the input is disabled. */\n  @Input()\n  set disabled(val: boolean) {\n    if (val !== this._disabled) {\n      this._disabled = toBoolean(val);\n      if (this._field) {\n        if (!val && this._hasDisabledClass) {\n          this._renderer.removeClass(this._field._getHostElement(), this._field.classes.disabled);\n          if (this._cursorClass) {\n            this._renderer.addClass(this._field._getHostElement(), this._cursorClass);\n          }\n          this._hasDisabledClass = undefined;\n        } else if (val) {\n          this._renderer.addClass(this._field._getHostElement(), this._field.classes.disabled);\n          if (this._cursorClass) {\n            this._renderer.removeClass(this._field._getHostElement(), this._cursorClass);\n          }\n          this._hasDisabledClass = true;\n        }\n      }\n      this.stateChanges.next();\n    }\n  }\n  get disabled(): boolean {\n    if (this.ngControl && this.ngControl.disabled !== null) {\n      return this.ngControl.disabled;\n    }\n    return this._disabled;\n  }\n\n  @Input()\n  set required(value: boolean) {\n    this._required = toBoolean(value);\n  }\n  get required(): boolean { return this._required; }\n\n  @Input()\n  set multiple(value: boolean) {\n    this._multiple = toBoolean(value);\n  }\n  get multiple(): boolean { return this._multiple; }\n\n  /**\n   * @deprecated has been deprecated in favor of `compareWith`\n   */\n  @Input()\n  set valueKey(fn: (opt: unknown) => unknown) {\n    this._valueKey = fn;\n    console.warn('LySelect: `[valueKey]` has been deprecated in favor of `[compareWith]`');\n  }\n  get valueKey(): (opt: unknown) => unknown { return this._valueKey; }\n\n  @Input()\n  set placeholder(val: string) {\n    this._placeholder = val;\n  }\n  get placeholder(): string { return this._placeholder; }\n\n  /**\n   * Function to compare the option values with the selected values. The first argument\n   * is a value from an option. The second is a value from the selection. A boolean\n   * should be returned.\n   */\n  @Input()\n  get compareWith() { return this._compareWith; }\n  set compareWith(fn: (o1: any, o2: any) => boolean) {\n    if (typeof fn !== 'function' && isDevMode) {\n      throw getLySelectNonFunctionValueError();\n    }\n    this._compareWith = fn;\n    if (this._selectionModel) {\n      // A different comparator means the selection could change.\n      this._initializeSelection();\n    }\n  }\n\n  /**\n   * Function used to sort the values in a select in multiple mode.\n   * Follows the same logic as `Array.prototype.sort`.\n   */\n  @Input() sortComparator: (a: LyOption, b: LyOption, options: LyOption[]) => number;\n\n  get focused() {\n    return this._focused;\n  }\n\n  get empty() {\n    return !this._selectionModel || this._selectionModel.isEmpty();\n  }\n\n  get floatingLabel() {\n    return this._opened ? true : !this.empty;\n  }\n\n  /** The value displayed in the trigger. */\n  get triggerValue(): string {\n    if (this._multiple) {\n      const selectedOptions = this._selectionModel.selected.map(option => option.viewValue);\n\n      if (this._theme.variables.direction === Dir.rtl) {\n        selectedOptions.reverse();\n      }\n\n      return selectedOptions.join(', ');\n    }\n\n    return this._selectionModel.selected[0].viewValue;\n  }\n\n  /** Current selecteds */\n  get selected(): LyOption | LyOption[] {\n    const selected = this._selectionModel.selected;\n    return this.multiple ? selected : selected[0];\n  }\n\n  constructor(private _theme: LyTheme2,\n              readonly sRenderer: StyleRenderer,\n              private _renderer: Renderer2,\n              private _el: ElementRef,\n              private _overlay: LyOverlay,\n              /** @internal */\n              @Optional() public _field: LyField,\n              /** @internal */\n              public _cd: ChangeDetectorRef,\n              private _ngZone: NgZone,\n              /** @docs-private */\n              @Optional() @Self() public ngControl: NgControl,\n              @Optional() private _parentForm: NgForm,\n              @Optional() private _parentFormGroup: FormGroupDirective) {\n    super();\n    if (this.ngControl) {\n      // Note: we provide the value accessor through here, instead of\n      // the `providers` to avoid running into a circular import.\n      this.ngControl.valueAccessor = this;\n    }\n\n    this._cursorClass = this._theme.addStyle('lyField.select', {\n      '& {container}': {\n        cursor: 'pointer'\n      }\n    }, this._field._getHostElement(), null, STYLE_PRIORITY, FIELD_STYLES);\n\n  }\n\n  ngOnInit() {\n    this._selectionModel = new SelectionModel<LyOption>(this.multiple);\n    this.stateChanges.next();\n\n    // We need `distinctUntilChanged` here, because some browsers will\n    // fire the animation end event twice for the same animation. See:\n    // https://github.com/angular/angular/issues/24084\n    this._panelDoneAnimatingStream\n      .pipe(distinctUntilChanged(), takeUntil(this._destroy))\n      .subscribe(() => {\n        if (this._opened) {\n          this.openedChange.emit(true);\n        } else {\n          if (this._overlayRef) {\n            this._overlayRef.remove();\n            this._overlayRef = null;\n          }\n          this.openedChange.emit(false);\n          this.stateChanges.next();\n          this._cd.markForCheck();\n        }\n      });\n\n    const ngControl = this.ngControl;\n\n    // update styles on disabled\n    if (ngControl && ngControl.statusChanges) {\n      ngControl.statusChanges.pipe(takeUntil(this._destroy)).subscribe(() => {\n        this.disabled = !!ngControl.disabled;\n      });\n    }\n\n    // apply class {selectArrow} to `<select>`\n    this._renderer.addClass(this._field._getHostElement(), this._field.classes.selectArrow);\n\n    // apply default styles\n    this._renderer.addClass(this._el.nativeElement, this._field.classes.inputNative);\n    this._renderer.addClass(this._el.nativeElement, this.classes.root);\n  }\n\n  ngDoCheck() {\n    const oldVal = this.errorState;\n    const newVal = !!(this.ngControl && this.ngControl.invalid && (this.ngControl.touched || (this._form && this._form.submitted)));\n    if (newVal !== oldVal) {\n      this.errorState = newVal;\n      if (this._field) {\n        const errorClass = this._field.classes.errorState;\n        if (newVal) {\n          this._renderer.addClass(this._field._getHostElement(), errorClass);\n          this._errorClass = errorClass;\n        } else if (this._errorClass) {\n          this._renderer.removeClass(this._field._getHostElement(), errorClass);\n          this._errorClass = undefined;\n        }\n        this.stateChanges.next();\n      }\n    }\n  }\n\n  ngAfterContentInit() {\n    this._initKeyManager();\n\n    this.options.changes.pipe(startWith(null), takeUntil(this._destroy)).subscribe(() => {\n      this._resetOptions();\n      this._initializeSelection();\n    });\n\n    this._selectionModel.changed.pipe(takeUntil(this._destroy)).subscribe(event => {\n      event.added.forEach(option => option.select());\n      event.removed.forEach(option => option.deselect());\n    });\n\n    Promise.resolve().then(() => {\n      this.value = this.ngControl ? this.ngControl.value : this._value;\n      this.stateChanges.next();\n      this._cd.markForCheck();\n    });\n    this._keyManager.change.pipe(takeUntil(this._destroy)).subscribe(() => {\n      if (!this._opened && !this.multiple && this._keyManager.activeItem) {\n        this._keyManager.activeItem._selectViaInteraction();\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this._destroy.next();\n    this._destroy.complete();\n    this.stateChanges.complete();\n    if (this._overlayRef) {\n      this._overlayRef.destroy();\n    }\n  }\n\n  open() {\n    if (this.disabled || !this.options || !this.options.length || this._opened) {\n      return;\n    }\n    this._opened = true;\n    if (this._overlayRef) {\n      this._overlayRef.destroy();\n    }\n    this._overlayRef = this._overlay.create(this.templateRef, null, {\n      styles: {\n        top: 0,\n        left: 0,\n        pointerEvents: null\n      },\n      fnDestroy: this.close.bind(this),\n      onResizeScroll: this._updatePlacement.bind(this)\n    });\n    this._keyManager.withHorizontalOrientation(null);\n    this._triggerFontSize = parseInt(getComputedStyle(this._getHostElement()).fontSize || '0');\n    this._highlightCorrectOption();\n    this._cd.markForCheck();\n    this.stateChanges.next();\n    this._ngZone.onStable.pipe(\n      take(1)\n    ).subscribe(() => this._updatePlacement(true));\n  }\n\n  close() {\n    if (this._opened) {\n      this._opened = false;\n      this._overlayRef?.detach();\n      this._keyManager.withHorizontalOrientation(this._theme.variables.direction);\n      this._cd.markForCheck();\n      this.onTouched();\n    }\n  }\n\n  /** @docs-private */\n  onContainerClick() {\n    this.focus();\n    this.open();\n  }\n\n  /** Focuses the select element. */\n  focus(options?: FocusOptions): void {\n    this._getHostElement().focus(options);\n  }\n\n  _getHostElement() {\n    return this._el.nativeElement;\n  }\n\n  /**\n   * Sets the \"value\" property on the input element.\n   *\n   * @param value The checked value\n   */\n  writeValue(value: any): void {\n    this.value = value;\n  }\n\n  /**\n   * Registers a function called when the control value changes.\n   *\n   * @param fn The callback function\n   */\n  registerOnChange(fn: (value: any) => any): void {\n    this.onChange = (_valueString: string) => {\n      fn(this.value);\n    };\n  }\n\n  /**\n   * Registers a function called when the control is touched.\n   *\n   * @param fn The callback function\n   */\n  registerOnTouched(fn: () => any): void { this.onTouched = fn; }\n\n  /**\n   * Disables the select. Part of the ControlValueAccessor interface required\n   * to integrate with Angular's core forms API.\n   *\n   * @param isDisabled Sets whether the component is disabled.\n   */\n  setDisabledState(isDisabled: boolean) {\n    this.disabled = isDisabled;\n    this._cd.markForCheck();\n    this.stateChanges.next();\n  }\n\n  /** Handles all keydown events on the select. */\n  _handleKeydown(event: KeyboardEvent): void {\n    if (!this.disabled) {\n      this._opened ? this._handleOpenKeydown(event) : this._handleClosedKeydown(event);\n    }\n  }\n\n  /** Handles keyboard events while the select is closed. */\n  private _handleClosedKeydown(event: KeyboardEvent): void {\n    const keyCode = event.keyCode;\n    const isArrowKey = keyCode === DOWN_ARROW || keyCode === UP_ARROW ||\n                       keyCode === LEFT_ARROW || keyCode === RIGHT_ARROW;\n    const isOpenKey = keyCode === ENTER || keyCode === SPACE;\n    const manager = this._keyManager;\n\n    // Open the select on ALT + arrow key to match the native <select>\n    if (!manager.isTyping() && (isOpenKey && !hasModifierKey(event)) ||\n      ((this.multiple || event.altKey) && isArrowKey)) {\n      event.preventDefault(); // prevents the page from scrolling down when pressing space\n      this.open();\n    } else if (!this.multiple) {\n      manager.onKeydown(event);\n    }\n  }\n\n  /** Handles keyboard events when the selected is open. */\n  private _handleOpenKeydown(event: KeyboardEvent): void {\n    const manager = this._keyManager;\n    const keyCode = event.keyCode;\n    const isArrowKey = keyCode === DOWN_ARROW || keyCode === UP_ARROW;\n    const isTyping = manager.isTyping();\n\n    if (isArrowKey && event.altKey) {\n      // Close the select on ALT + arrow key to match the native <select>\n      event.preventDefault();\n      this.close();\n      // Don't do anything in this case if the user is typing,\n      // because the typing sequence can include the space key.\n    } else if (!isTyping && (keyCode === ENTER || keyCode === SPACE) && manager.activeItem &&\n      !hasModifierKey(event)) {\n      event.preventDefault();\n      manager.activeItem._selectViaInteraction();\n    } else if (!isTyping && this._multiple && keyCode === A && event.ctrlKey) {\n      event.preventDefault();\n      const hasDeselectedOptions = this.options.some(opt => !opt.disabled && !opt.selected);\n\n      this.options.forEach(option => {\n        if (!option.disabled) {\n          hasDeselectedOptions ? option.select() : option.deselect();\n        }\n      });\n    } else {\n      const previouslyFocusedIndex = manager.activeItemIndex;\n\n      manager.onKeydown(event);\n\n      if (this._multiple && isArrowKey && event.shiftKey && manager.activeItem &&\n          manager.activeItemIndex !== previouslyFocusedIndex) {\n        manager.activeItem._selectViaInteraction();\n      }\n    }\n  }\n\n  private _initializeSelection(): void {\n    // Defer setting the value in order to avoid the \"Expression\n    // has changed after it was checked\" errors from Angular.\n    Promise.resolve().then(() => {\n      this._setSelectionByValue(this.ngControl ? this.ngControl.value : this._value);\n      this.stateChanges.next();\n    });\n  }\n\n  /**\n   * Sets the selected option based on a value. If no option can be\n   * found with the designated value, the select trigger is cleared.\n   */\n  private _setSelectionByValue(value: any | any[]): void {\n    if (this.multiple && value) {\n      if (!Array.isArray(value) && isDevMode()) {\n        throw getLySelectNonArrayValueError();\n      }\n\n      this._selectionModel.clear();\n      value.forEach((currentValue: any) => this._selectValue(currentValue));\n      this._sortValues();\n    } else {\n      this._selectionModel.clear();\n      const correspondingOption = this._selectValue(value);\n\n      // Shift focus to the active item. Note that we shouldn't do this in multiple\n      // mode, because we don't know what option the user interacted with last.\n      if (correspondingOption) {\n        this._keyManager.updateActiveItem(correspondingOption);\n      } else if (!this._opened) {\n        // Otherwise reset the highlighted option. Note that we only want to do this while\n        // closed, because doing it while open can shift the user's focus unnecessarily.\n        this._keyManager.updateActiveItem(-1);\n      }\n    }\n\n    this._cd.markForCheck();\n  }\n\n  /**\n   * Finds and selects and option based on its value.\n   * @returns Option that has the corresponding value.\n   */\n  private _selectValue(value: any): LyOption | undefined {\n    const correspondingOption = this.options.find((option: LyOption) => {\n      if (this._valueKey !== same) {\n        return this.valueKey(option.value) === this.valueKey(value);\n      }\n      try {\n        // Treat null as a special reset value.\n        return option.value != null && this._compareWith(option.value, value);\n      } catch (error) {\n        if (isDevMode()) {\n          // Notify developers of errors in their comparator.\n          console.warn(error);\n        }\n        return false;\n      }\n    });\n\n    if (correspondingOption) {\n      this._selectionModel.select(correspondingOption);\n    }\n\n    return correspondingOption;\n  }\n\n  private _updatePlacement(updateScroll: boolean) {\n    const el = this._overlayRef!.containerElement as HTMLElement;\n    const container = el.querySelector('div')!;\n    const triggerFontSize = this._triggerFontSize;\n    const { nativeElement } = this.valueTextDivRef;\n    let panelWidth: number;\n\n    if (this.multiple) {\n      panelWidth = nativeElement.offsetWidth + triggerFontSize * 4;\n    } else {\n      panelWidth = nativeElement.offsetWidth + triggerFontSize * 2;\n    }\n\n\n    // reset height & width\n    this._renderer.setStyle(container, 'height', 'initial');\n    this._renderer.setStyle(container, 'width', `${panelWidth}px`);\n\n\n    let selectedElement: HTMLElement | null = this._selectionModel.isEmpty()\n        ? el.querySelector('ly-option')\n        : this._selectionModel.selected[0]._getHostElement() as HTMLElement;\n\n    if (!selectedElement) {\n      selectedElement = (el.firstElementChild!.firstElementChild! || el.firstElementChild!) as HTMLElement;\n    }\n\n    const offset = {\n      y: -(nativeElement.offsetHeight / 2 + selectedElement.offsetTop + selectedElement.offsetHeight / 2),\n      x: -triggerFontSize\n    };\n\n    // scroll to selected option\n    if (container.scrollHeight !== container.offsetHeight) {\n      if (updateScroll) {\n        if (container.scrollTop === selectedElement.offsetTop) {\n          container.scrollTop = container.scrollTop - (container.offsetHeight / 2) + selectedElement.offsetHeight / 2;\n        } else {\n          container.scrollTop = container.scrollTop\n          - (container.offsetHeight / 2 - (selectedElement.offsetTop - container.scrollTop)) + selectedElement.offsetHeight / 2;\n        }\n      }\n      offset.y = container.scrollTop + offset.y;\n    }\n\n    if (this.multiple) {\n      offset.x -= 24;\n    }\n\n    const position = new Positioning(\n      YPosition.below,\n      XPosition.after,\n      null as any,\n      nativeElement,\n      el,\n      this._theme.variables,\n      offset,\n      false\n    );\n\n    // set position\n    this._renderer.setStyle(el, 'transform', `translate3d(${position.x}px, ${position.y}px, 0)`);\n    this._renderer.setStyle(el, 'transform-origin', `${position.ox} ${position.oy} 0`);\n\n    // set height & width\n    this._renderer.setStyle(container, 'height', position.height);\n    const width = position.width === 'initial'\n          ? `${panelWidth}px`\n          : position.width;\n    this._renderer.setStyle(container, 'width', width);\n  }\n\n  /** Sets up a key manager to listen to keyboard events on the overlay panel. */\n  private _initKeyManager() {\n    this._keyManager = new ActiveDescendantKeyManager<LyOption>(this.options)\n      .withTypeAhead(this._typeaheadDebounceInterval)\n      .withVerticalOrientation()\n      .withHorizontalOrientation(this._theme.variables.direction)\n      .withHomeAndEnd()\n      .withAllowedModifierKeys(['shiftKey']);\n\n    this._keyManager.tabOut.pipe(takeUntil(this._destroy)).subscribe(() => {\n      if (this._opened) {\n        // Select the active item when tabbing away. This is consistent with how the native\n        // select behaves. Note that we only want to do this in single selection mode.\n        if (!this.multiple && this._keyManager.activeItem) {\n          this._keyManager.activeItem._selectViaInteraction();\n        }\n\n        // Restore focus to the trigger before closing. Ensures that the focus\n        // position won't be lost if the user got focus into the overlay.\n        this.focus();\n        this.close();\n      }\n    });\n\n    this._keyManager.change.pipe(takeUntil(this._destroy)).subscribe(() => {\n      if (this._opened) {\n        this._scrollActiveOptionIntoView();\n      } else if (!this._opened && !this.multiple && this._keyManager.activeItem) {\n        this._keyManager.activeItem._selectViaInteraction();\n      }\n    });\n  }\n\n  /** Sorts the selected values in the selected based on their order in the panel. */\n  private _sortValues() {\n    if (this.multiple) {\n      const options = this.options.toArray();\n\n      this._selectionModel.sort((a, b) => {\n        return this.sortComparator ? this.sortComparator(a, b, options) :\n                                     options.indexOf(a) - options.indexOf(b);\n      });\n      this.stateChanges.next();\n    }\n  }\n\n  private _resetOptions(): void {\n    const changedOrDestroyed = merge(this.options.changes, this._destroy);\n\n    this.optionSelectionChanges.pipe(takeUntil(changedOrDestroyed)).subscribe(event => {\n      this._onSelect(event.source, event.isUserInput);\n\n      if (event.isUserInput && !this.multiple && this._opened) {\n        this.close();\n        this.focus();\n      }\n    });\n  }\n\n  /** Invoked when an option is clicked. */\n  private _onSelect(option: LyOption, isUserInput: boolean): void {\n    const wasSelected = this._selectionModel.isSelected(option);\n\n    if (option.value == null && !this._multiple) {\n      option.deselect();\n      this._selectionModel.clear();\n\n      if (this.value != null) {\n        this._propagateChanges(option.value);\n      }\n    } else {\n      if (wasSelected !== option.selected) {\n        option.selected ? this._selectionModel.select(option) :\n                          this._selectionModel.deselect(option);\n      }\n\n      if (isUserInput) {\n        this._keyManager.setActiveItem(option);\n      }\n\n      if (this.multiple) {\n        this._sortValues();\n        if (isUserInput) {\n          // In case the user selected the option with their mouse, we\n          // want to restore focus back to the trigger, in order to\n          // prevent the select keyboard controls from clashing with\n          // the ones from `ly-option`.\n          this.focus();\n        }\n      }\n    }\n\n    if (wasSelected !== this._selectionModel.isSelected(option)) {\n      this._propagateChanges();\n    }\n\n    this.stateChanges.next();\n  }\n\n  /** Emits change event to set the model value. */\n  private _propagateChanges(fallbackValue?: any): void {\n    let valueToEmit: any = null;\n\n    if (this.multiple) {\n      valueToEmit = (this.selected as LyOption[]).map(option => option.value);\n    } else {\n      valueToEmit = this.selected ? (this.selected as LyOption).value : fallbackValue;\n    }\n\n    this._value = valueToEmit;\n    this.valueChange.emit(valueToEmit);\n    this.onChange(valueToEmit);\n    this.selectionChange.emit(new LySelectChange(this, valueToEmit));\n    this._cd.markForCheck();\n  }\n\n  /**\n   * Highlights the selected item. If no option is selected, it will highlight\n   * the first item instead.\n   */\n  private _highlightCorrectOption(): void {\n    if (this._keyManager) {\n      if (this.empty) {\n        this._keyManager.setFirstItemActive();\n      } else {\n        this._keyManager.setActiveItem(this._selectionModel.selected[0]);\n      }\n    }\n  }\n\n  /** Scrolls the active option into view. */\n  private _scrollActiveOptionIntoView(): void {\n    const el = this._overlayRef!.containerElement as HTMLElement;\n    const container = el.querySelector('div')!;\n    const activeOption = this._keyManager.activeItem!._getHostElement();\n    // const containerRect = container.getBoundingClientRect();\n    // const activeOptionRect = ;\n    if (typeof activeOption.scrollIntoView === 'function') {\n      if (container.scrollTop > activeOption.offsetTop) {\n        container.scrollTop = activeOption.offsetTop;\n      } else if (\n        container.scrollTop + container.offsetHeight < activeOption.offsetTop + activeOption.offsetHeight\n      ) {\n        container.scrollTop = activeOption.offsetTop - container.offsetHeight + activeOption.offsetHeight;\n      }\n    }\n  }\n\n}\n\n/** Event object emitted by LyOption when selected or deselected. */\nexport class LyOptionSelectionChange {\n  constructor(\n    /** Reference to the option that emitted the event. */\n    public source: LyOption,\n    /** Whether the change in the option's value was a result of a user action. */\n    public isUserInput = false) { }\n}\n\n/** @docs-private */\nexport class LyOptionBase {\n  constructor(\n    public _theme: LyTheme2,\n    public _ngZone: NgZone,\n    public _platform: Platform\n  ) { }\n}\n\n/** @docs-private */\nexport const LyOptionMixinBase = mixinDisableRipple(LyOptionBase);\n\n/**\n * @dynamic\n */\n@Component({\n  selector: 'ly-option',\n  templateUrl: './option.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  host: {\n    'role': 'option',\n    '(keydown)': '_handleKeydown($event)',\n    '[attr.tabindex]': '_getTabIndex()',\n  },\n  inputs: [\n    'disableRipple'\n  ],\n  providers: [\n    StyleRenderer\n  ]\n})\nexport class LyOption extends LyOptionMixinBase implements WithStyles, FocusableOption, OnInit, OnChanges {\n  /** @docs-private */\n  readonly classes = this._theme.addStyleSheet(STYLES, STYLE_PRIORITY);\n  private _value: any;\n  private _selected = false;\n  private _disabled = false;\n\n  @ViewChild('rippleContainer') _rippleContainer: ElementRef;\n\n  /** Event emitted when the option is selected or deselected. */\n  // tslint:disable-next-line: no-output-on-prefix\n  @Output() readonly onSelectionChange = new EventEmitter<LyOptionSelectionChange>();\n\n  @HostListener('click') _onClick() {\n    this._selectViaInteraction();\n  }\n\n  /** Whether or not the option is currently selected. */\n  get selected(): boolean { return this._selected; }\n\n  /** Whether the wrapping component is in multiple selection mode. */\n  get multiple() { return this._select && this._select.multiple; }\n\n  /**\n   * Tracks simple string values bound to the option element.\n   */\n  @Input('value')\n  set value(value: any) {\n    this._value = value;\n  }\n  get value() {\n    return this._value;\n  }\n\n  /** Whether the option is disabled. */\n  @Input()\n  set disabled(value: any) {\n    this._disabled = coerceBooleanProperty(value);\n  }\n  get disabled() {\n    return this._disabled;\n  }\n\n  @Style<string | null>(\n    value => (theme: ThemeVariables) => (className: string) => `${className}{color:${theme.colorOf(value)};}`\n  )\n  _selectedColor: string | null;\n\n  /** The displayed value of the option. */\n  get viewValue(): string {\n    return ((this._getHostElement() as Element).textContent || '').trim();\n  }\n\n  /** The color of Select option */\n  get _color() {\n    return this._selected ? this._select._field.color : null;\n  }\n\n  /**\n   * @deprecated use instead `selected`\n   */\n  get isSelected(): boolean {\n    return this._selected;\n  }\n\n  constructor(readonly sRenderer: StyleRenderer,\n              /** @internal */\n              readonly _select: LySelect,\n              private _el: ElementRef,\n              /** @internal */\n              public _rippleService: LyRippleService,\n              _renderer: Renderer2,\n              _theme: LyTheme2,\n              /** @internal */\n              public _cd: ChangeDetectorRef,\n              _ngZone: NgZone,\n              platform: Platform\n  ) {\n    super(_theme, _ngZone, platform);\n    _renderer.addClass(_el.nativeElement, this.classes.option);\n    this._triggerElement = _el;\n  }\n\n  ngOnInit() {\n    if (this.disableRipple == null) {\n      this.disableRipple = DEFAULT_DISABLE_RIPPLE;\n    }\n  }\n\n  ngOnChanges() { }\n\n  /** Applies the styles for an active item to this item. */\n  setActiveStyles(): void {\n    this.sRenderer.addClass(this.classes.optionActive);\n  }\n\n  /** Applies the styles for an inactive item to this item. */\n  setInactiveStyles(): void {\n    this.sRenderer.removeClass(this.classes.optionActive);\n  }\n\n  /** Gets the label to be used when determining whether the option should be focused. */\n  getLabel(): string {\n    return this.viewValue;\n  }\n\n  /** Selects the option. */\n  select(): void {\n    if (!this._selected) {\n      this._selected = true;\n      this._selectedColor = this._color;\n      this._cd.markForCheck();\n      this._emitSelectionChangeEvent();\n    }\n  }\n\n  /** Deselects the option. */\n  deselect(): void {\n    if (this._selected) {\n      this._selected = false;\n      this._selectedColor = null;\n      this._cd.markForCheck();\n      this._emitSelectionChangeEvent();\n    }\n  }\n\n  /** Sets focus onto this option. */\n  focus(_origin?: FocusOrigin, options?: FocusOptions) {\n    const element = this._getHostElement();\n\n    if (typeof element.focus === 'function') {\n      element.focus(options);\n    }\n  }\n\n  /** Ensures the option is selected when activated from the keyboard. */\n  _handleKeydown(event: KeyboardEvent): void {\n    // tslint:disable-next-line: deprecation\n    if ((event.keyCode === ENTER || event.keyCode === SPACE) && !hasModifierKey(event)) {\n      this._selectViaInteraction();\n\n      // Prevent the page from scrolling down and form submits.\n      event.preventDefault();\n    }\n  }\n\n  /**\n   * `Selects the option while indicating the selection came from the user. Used to\n   * determine if the select's view -> model callback should be invoked.`\n   */\n  _selectViaInteraction(): void {\n    if (!this.disabled) {\n      this._selected = this.multiple ? !this._selected : true;\n      this._selectedColor = this._color;\n      this._cd.markForCheck();\n      this._emitSelectionChangeEvent(true);\n    }\n  }\n\n  /** @internal */\n  _getHostElement(): HTMLElement {\n    return this._el.nativeElement;\n  }\n\n  /** Returns the correct tabindex for the option depending on disabled state. */\n  _getTabIndex(): string {\n    return this.disabled ? '-1' : '0';\n  }\n\n  /** Emits the selection change event. */\n  private _emitSelectionChangeEvent(isUserInput = false): void {\n    this.onSelectionChange.emit(new LyOptionSelectionChange(this, isUserInput));\n  }\n\n}\n\nfunction same(o: unknown): unknown {\n  return o;\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { LyCommonModule, LyOverlayModule } from '@alyle/ui';\nimport { LyCheckboxModule } from '@alyle/ui/checkbox';\n\nimport { LySelect, LyOption, LySelectTrigger } from './select';\n\n@NgModule({\n  declarations: [LySelect, LyOption, LySelectTrigger],\n  imports: [\n    CommonModule,\n    LyCommonModule,\n    LyCheckboxModule,\n    LyOverlayModule\n  ],\n  exports: [LySelect, LyOption, LySelectTrigger, LyCommonModule]\n})\nexport class LySelectModule { }\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["FIELD_STYLES"],"mappings":"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"}